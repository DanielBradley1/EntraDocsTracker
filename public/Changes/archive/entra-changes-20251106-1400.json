{
  "sha": "39101aba7d2a32f6e1dbc97a2289108851967471",
  "url": "https://github.com/MicrosoftDocs/entra-docs/commit/39101aba7d2a32f6e1dbc97a2289108851967471",
  "author": "learn-build-service-prod[bot]",
  "email": "113403604+learn-build-service-prod[bot]@users.noreply.github.com",
  "date": "2025-11-06T12:02:56Z",
  "message": "Merge pull request #10313 from MicrosoftDocs/main\n\nAuto Publish – main to live - 2025-11-06 12:00 UTC",
  "ai_summary": {
    "Messages": "{\"role\":\"user\",\"content\":\"The following is the commit files that have changed: [\\r\\n  {\\r\\n    \\\"sha\\\": \\\"51142c2b6ab907fdc1589685a199a1c06438668c\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/how-to-azure-monitor.md\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 117,\\r\\n    \\\"deletions\\\": 158,\\r\\n    \\\"changes\\\": 275,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fhow-to-azure-monitor.md\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fhow-to-azure-monitor.md\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fhow-to-azure-monitor.md?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\",\\r\\n    \\\"patch\\\": \\\"@@ -6,252 +6,211 @@ manager: dougeby\\\\n ms.service: entra-external-id\\\\n ms.subservice: external\\\\n ms.topic: how-to\\\\n-ms.date: 07/07/2025\\\\n+ms.date: 10/01/2025\\\\n ms.author: cmulligan\\\\n ms.custom: sfi-ga-nochange, sfi-image-nochange\\\\n+\\\\n #Customer intent: As an it admin, I want to learn how to set up Azure Monitor in external tenants to collect and analyze data in this tenant.\\\\n ---\\\\n-# Set up Azure Monitor in external tenants (preview)\\\\n+# Set up Azure Monitor in external tenants\\\\n \\\\n [!INCLUDE [applies-to-external-only](../includes/applies-to-external-only.md)]\\\\n \\\\n-[Azure Monitor](/azure/azure-monitor/overview) is a comprehensive solution for collecting, analyzing, and responding to monitoring data from your cloud and on-premises environments. The diagnostic settings on the monitored resource specify what data to send and where to send it. For Microsoft Entra, the destination options include [Azure Storage](/azure/storage/blobs/storage-blobs-introduction), [Log Analytics](/azure/azure-monitor/essentials/resource-logs#send-to-log-analytics-workspace) and [Azure Event Hubs](/azure/event-hubs/event-hubs-about).\\\\n+[Azure Monitor](/azure/azure-monitor/overview) provides a comprehensive solution for collecting, analyzing, and responding to monitoring data from your cloud and on-premises environments. The diagnostic settings on the monitored resource specify what data to send and where to send it. For Microsoft Entra, you can send data to [Azure Storage](/azure/storage/blobs/storage-blobs-introduction), [Log Analytics](/azure/azure-monitor/essentials/resource-logs#send-to-log-analytics-workspace), or [Azure Event Hubs](/azure/event-hubs/event-hubs-about).\\\\n \\\\n-:::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/azure-monitor-flow.png\\\\\\\" alt-text=\\\\\\\"Diagram of the Azure Monitor flow.\\\\\\\":::\\\\n+When you transfer external tenant logs to other monitoring solutions or storage locations, be aware that these logs might contain personal data. When processing personal data, use appropriate security measures to protect it. These measures should prevent unauthorized or unlawful processing by using appropriate technical and organizational safeguards.\\\\n \\\\n-When you plan to transfer external tenant logs to different monitoring solutions, or repository, consider that external tenant logs contain personal data. When you process such data, ensure you use appropriate security measures on the personal data. It includes protection against unauthorized or unlawful processing, using appropriate technical or organizational measures.\\\\n+This article describes how to configure Azure Monitor in an external tenant so you can collect and analyze data in your tenant. It also explains how to configure diagnostic settings to send logs and metrics to a Log Analytics workspace in your workforce tenant.\\\\n \\\\n ## Deployment overview\\\\n \\\\n-The external tenant uses [Microsoft Entra monitoring](/entra/identity/monitoring-health/overview-monitoring-health). Unlike Microsoft Entra workforce tenants, an external tenant can't have a subscription associated with it. So, we need to take extra steps to enable the integration between the external tenant and Log Analytics in the workforce tenant, which is where we send the logs.\\\\n-To enable [Diagnostic settings](/azure/azure-monitor/essentials/diagnostic-settings) in the workforce tenant, use [Azure Lighthouse](/azure/lighthouse/overview). Azure Lighthouse [delegates the resource](/azure/lighthouse/concepts/architecture), allowing the external tenant (the **Service Provider**) to manage the resource in the workforce tenant (the **Customer**).\\\\n-\\\\n-> [!TIP]\\\\n-> Azure Lighthouse is typically used to manage resources for multiple customers. However, it can also be used to simplify cross-tenant administration [within an enterprise that has multiple Microsoft Entra tenants of its own](/azure/lighthouse/concepts/enterprise). In our case, we're using it to delegate management of a single resource group.\\\\n-\\\\n-By following the steps in this article, you'll create a new resource group named _ExtIDMonitor_ in your workforce tenant and gain access to the same resource group containing the [Log Analytics workspace](/azure/azure-monitor/logs/quick-create-workspace) in your external tenant. You'll also be able to transfer the logs from external tenant to your Log Analytics workspace.\\\\n-\\\\n-During this deployment, you'll authorize a user or group in your external tenant directory to configure the Log Analytics workspace instance within the tenant that contains your Azure subscription. To create the authorization, you deploy an [Azure Resource Manager](/azure/azure-resource-manager/) template to the subscription that contains the Log Analytics workspace.\\\\n-\\\\n-The following diagram depicts the components you'll configure in your workforce tenant and external tenants.\\\\n-\\\\n-:::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/resource-group-projection.png\\\\\\\" alt-text=\\\\\\\"Flow chart of the resource group projection.\\\\\\\":::\\\\n+External tenants use [Microsoft Entra monitoring](/entra/identity/monitoring-health/overview-monitoring-health). Unlike workforce tenants, an external tenant can't have an associated subscription. To enable monitoring in an external tenant, sign in to your workforce tenant to authenticate the subscription during configuration.  \\\\n+You can also use [Azure Lighthouse](/azure/lighthouse/overview) to enable diagnostic settings for a workforce tenant (the Customer) within your external tenant (the Service Provider).\\\\n \\\\n-During this deployment, you'll configure your external tenant where logs are generated. You'll also configure your external tenant where the Log Analytics workspace will be hosted. The external tenant accounts used (such as your admin account) should be assigned the [Global Administrator](/entra/identity/role-based-access-control/permissions-reference#global-administrator) role on the external tenant. The account you'll use to run the deployment in the external tenant must be assigned the [Owner](/azure/role-based-access-control/built-in-roles#owner) role in the Microsoft Entra subscription. It's also important to make sure you're signed in to the correct directory as you complete each step as described.\\\\n-\\\\n-In summary, you'll use Azure Lighthouse to allow a user or group in your external tenant to manage a resource group in a subscription associated with a different tenant (the workforce tenant). After this authorization is completed, the subscription and Log Analytics workspace can be selected as a target in the Diagnostic settings in external tenant.\\\\n+In this configuration, you use a wizard. You can start the wizard from either of these entry points: the **Diagnostic settings** page or the **Security Store** page. This article covers both approaches.\\\\n \\\\n ## Prerequisites\\\\n \\\\n - An Azure subscription. If you don't have one, create a <a href=\\\\\\\"https://azure.microsoft.com/pricing/purchase-options/azure-account?cid=msft_learn\\\\\\\" target=\\\\\\\"_blank\\\\\\\">free account</a> before you begin.\\\\n - A Microsoft Entra account with the [Owner](/azure/role-based-access-control/built-in-roles#owner) role in the Microsoft Entra subscription.\\\\n-- An account in the external tenant that's been assigned the [Global Administrator](/entra/identity/role-based-access-control/permissions-reference#global-administrator) role. \\\\n-\\\\n-## Configuration overview\\\\n-\\\\n-To follow the configuration steps in this article, we recommend opening two separate browser windows or tabs: one for the workforce tenant and one for the external tenant. This setup will help you switch between the two tenants as needed.\\\\n-\\\\n-## Step 1: Workforce tenant configuration - create resource group and logs workspace\\\\n-\\\\n-### Create a resource group\\\\n+- An account in the external tenant that's been assigned the [Security Administrator](/entra/identity/role-based-access-control/permissions-reference#security-administrator) or the [Application Administrator](/entra/identity/role-based-access-control/permissions-reference#application-administrator) role.\\\\n \\\\n-First, create, or choose a resource group that contains the destination Log Analytics workspace that will receive data from external tenant. You'll specify the resource group name when you deploy the Azure Resource Manager template.\\\\n+> [!IMPORTANT]\\\\n+> This feature supports only the new [Azure Role-Based Access Control (RBAC) Owner role](/azure/role-based-access-control/built-in-roles/privileged#owner), not the classic administrator roles. For instructions on converting classic administrator roles to Azure RBAC, see [Azure classic subscription administrators](/azure/role-based-access-control/classic-administrators?tabs=azure-portal). After you complete the conversion, refresh the page to apply the changes.\\\\n \\\\n-1. Sign in to the [Azure portal](https://portal.azure.com).\\\\n-1. If you have access to multiple tenants, select the **Settings** icon in the top menu to switch to your workforce tenant from the **Directories + subscriptions** menu.\\\\n-1. [Create a resource group](/azure/azure-resource-manager/management/manage-resource-groups-portal#create-resource-groups) or choose an existing one. This example uses a resource group named _ExtIDMonitor_.\\\\n-\\\\n-### Create a Log Analytics workspace\\\\n+## Start the wizard to set up Azure Lighthouse\\\\n \\\\n-A **Log Analytics workspace** is a unique environment for Azure Monitor log data. You'll use this Log Analytics workspace to collect data from external tenant, and then visualize it with queries.\\\\n-\\\\n-1. Sign in to the [Azure portal](https://portal.azure.com).\\\\n-1. If you have access to multiple tenants, select the **Settings** icon in the top menu to switch to your workforce tenant from the **Directories + subscriptions** menu.\\\\n-1. [Create a Log Analytics workspace](/azure/azure-monitor/logs/quick-create-workspace). This example uses a Log Analytics workspace named _ExtIDLogAnalytics_, in a resource group named _ExtIDMonitor_.\\\\n-\\\\n-### Add microsoft.insights as a resource provider\\\\n-\\\\n-In this step, you choose your external tenant as a **service provider**. You also define the authorizations you need to assign the appropriate built-in roles to groups in your Microsoft Entra tenant.\\\\n-To see all resource providers, and the registration status for your subscription:\\\\n-\\\\n-1. Sign in to the [Azure portal](https://portal.azure.com).\\\\n-1. If you have access to multiple tenants, select the **Settings** icon in the top menu to switch to your workforce tenant from the **Directories + subscriptions** menu.\\\\n-1. On the Azure portal menu, search for **Subscriptions**. \\\\n-1. Select the subscription you want to view.\\\\n-1. On the left menu, under **Settings**, select **Resource providers**.\\\\n-1. Select the **microsoft.insights** resource provider, and select **Register**.\\\\n+To configure Azure Lighthouse in an external tenant, start the wizard from either the **Diagnostic settings** page or the **Security Store** page. Choose one of the following tabs with the entry points to get started.\\\\n \\\\n-## Step 2: External tenant configuration - get external tenant ID and create a group for external ID monitoring\\\\n+# [Diagnostic settings](#tab/diagnostic-settings)\\\\n \\\\n-### Get your external tenant ID\\\\n+1. Sign in to the [Microsoft Entra admin center](https://entra.microsoft.com).\\\\n+1. If you have access to multiple tenants, use the **Settings** icon :::image type=\\\\\\\"icon\\\\\\\" source=\\\\\\\"media/common/admin-center-settings-icon.png\\\\\\\" border=\\\\\\\"false\\\\\\\"::: in the top menu and switch to your external tenant from the **Directories + subscriptions** menu.\\\\n+1. Browse to **Entra ID** in your external tenant and select **Monitoring & health** > **Diagnostic settings**.\\\\n+1. Select **Start set up** to launch the wizard.\\\\n \\\\n-First, get the **Tenant ID** of your external tenant. You'll need this ID to configure the external tenant to send logs to the Log Analytics workspace in the workforce tenant.\\\\n+# [Security Store](#tab/security-store)\\\\n \\\\n 1. Sign in to the [Microsoft Entra admin center](https://entra.microsoft.com).\\\\n 1. If you have access to multiple tenants, use the **Settings** icon :::image type=\\\\\\\"icon\\\\\\\" source=\\\\\\\"media/common/admin-center-settings-icon.png\\\\\\\" border=\\\\\\\"false\\\\\\\"::: in the top menu and switch to your external tenant from the **Directories + subscriptions** menu.\\\\n-1. Select **Tenant overview** and select **Overview**.\\\\n-1. Record the **Tenant ID**.\\\\n+1. Browse to **Home** > **Security Store** > **Monitor logs with Azure Monitor**.\\\\n+1. Select **Get started** to open the **Diagnostic settings** page. If Azure monitoring is already configured, you can select **View logs** to open the logs experience.\\\\n+1. Select **Start set up** to launch the wizard.\\\\n \\\\n-### Create a group for external ID monitoring\\\\n+---\\\\n \\\\n-Now create a group or user to which you want to give permission to the resource group you created earlier in the directory containing your subscription.\\\\n+:::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/start-set-up.png\\\\\\\" alt-text=\\\\\\\"Screenshot that shows how to start the wizard.\\\\\\\":::\\\\n \\\\n-To make management easier, we recommend using Microsoft Entra user _groups_ for each role, allowing you to add or remove individual users to the group rather than assigning permissions directly to that user. In this walkthrough, we'll add a security group.\\\\n+## Set up the Azure Lighthouse configuration in the wizard\\\\n \\\\n-1. Sign in to the [Microsoft Entra admin center](https://entra.microsoft.com).\\\\n-1. If you have access to multiple tenants, use the **Settings** icon :::image type=\\\\\\\"icon\\\\\\\" source=\\\\\\\"media/common/admin-center-settings-icon.png\\\\\\\" border=\\\\\\\"false\\\\\\\"::: in the top menu and switch to your external tenant from the **Directories + subscriptions** menu.\\\\n-1. Select **Groups**, and then select a group. If you don't have an existing group, create a **Security** group, then add members. For more information, follow the procedure [Create a basic group and add members using workforce tenant](/entra/fundamentals/how-to-manage-groups).\\\\n-1. Select **Overview** and record the group's **Object ID**.\\\\n+The following steps guide you through the wizard to set up Azure Lighthouse configuration in your external tenant.\\\\n \\\\n-## Step 3: Workforce tenant configuration - configure Azure Lighthouse\\\\n+### Step 1: Sign in to your workforce tenant\\\\n \\\\n-### Create an Azure Resource Manager template\\\\n+To set up Azure Lighthouse, sign in with an account that has access to the subscription that owns the external configuration tenant.\\\\n \\\\n-To create the custom authorization and delegation in Azure Lighthouse, we use an Azure Resource Manager template. This template grants the external tenant access to the Microsoft Entra resource group, which you created earlier, for example, _ExtIDMonitor_. Deploy the template from the GitHub sample by using the **Deploy to Azure** button, which opens the Azure portal and lets you configure and deploy the template directly in the portal. For these steps, make sure you're signed in to your Microsoft Entra workforce tenant (not the external tenant).\\\\n+:::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/sign-in-to-workforce.png\\\\\\\" alt-text=\\\\\\\"Screenshot that shows how to sign in to your workforce tenant.\\\\\\\":::\\\\n \\\\n-1. Sign in to the [Azure portal](https://portal.azure.com).\\\\n-1. If you have access to multiple tenants, select the **Settings** icon in the top menu to switch to your workforce tenant from the **Directories + subscriptions** menu. \\\\n-1. Use the **Deploy to Azure** button to open the Azure portal and deploy the template directly in the portal. For more information, see [create an Azure Resource Manager template](/azure/lighthouse/how-to/onboard-customer#create-an-azure-resource-manager-template).\\\\n+### Step 2: Fill out the project details\\\\n \\\\n-   [![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2Fexternal-id-azure-monitor%2Fmain%2Ftemplates%2FrgDelegatedResourceManagement.json)\\\\n+In this step, provide the details of your project. When you create a resource group and a Log Analytics workspace at the same time, you can select only one [location](https://azure.microsoft.com/explore/global-infrastructure/products-by-region/). This location is limited to the regions available for both the resource group and the Log Analytics workspace. To access the full list of locations, create the resource group and the Log Analytics workspace separately beforehand.\\\\n \\\\n-1. On the **Custom deployment** page, enter the following information:\\\\n+1. Select a **Subscription** from the dropdown.\\\\n+1. Use an existing **Resource Group** or create a new one.\\\\n+1. Provide a name for the new **Log Analytics workspace**. This name must be unique per resource group.\\\\n+1. Select an available **Region**.\\\\n+1. Select **Next**.\\\\n \\\\n-   | Field                 | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\\\\n-   | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\\\\n-   | Subscription          | Select the directory that contains the Azure subscription where the _ExtIDMonitor_ resource group was created.                                                                                                                                                                                                                                                                                                                                                                                                       |\\\\n-   | Region                | Select the region where the resource will be deployed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\\\\n-   | Msp Offer Name        | A name describing this definition. For example, _ExtIDMonitor_. It's the name that will be displayed in Azure Lighthouse.  The **MSP Offer Name** must be unique in your workforce tenant. To monitor multiple external tenants, use different names. |\\\\n-   | Msp Offer Description | A brief description of your offer. For example, _Enable Azure Monitor in the external tenant_.                                                                                                                                                                                                                                                                                                                                                                                                                                     |\\\\n-   | Managed By Tenant ID  | The **Tenant ID** of your external tenant (also known as the directory ID).                                                                                                                                                                                                                                                                                                                                                                                                                                              |\\\\n-   | Authorizations        | Specify a JSON array of objects that include the workforce tenant `principalId`, `principalIdDisplayName`, and Azure `roleDefinitionId`. The `principalId` is the **Object ID** of the group or user that will have access to resources in this Azure subscription. For this walkthrough, specify the group's Object ID that you recorded earlier in the external tenant. For the `roleDefinitionId`, use the [built-in role](/azure/role-based-access-control/built-in-roles) value for the _Contributor role_, `b24988ac-6180-42a0-ab88-20f7382dd24c`. |\\\\n-   | Rg Name               | The name of the resource group you create earlier in your workforce tenant. For example, _ExtIDMonitor_.                                                                                                                                                                                                                                                                                                                                                                                                |\\\\n+  :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/select-subscription.png\\\\\\\" alt-text=\\\\\\\"Screenshot that shows how to select a subscription.\\\\\\\":::\\\\n \\\\n-   The following example demonstrates an Authorizations array with one security group.\\\\n+### Step 3: Select user access\\\\n \\\\n-   ```json\\\\n-   [\\\\n-     {\\\\n-       \\\\\\\"principalId\\\\\\\": \\\\\\\"<Replace with group's OBJECT ID>\\\\\\\",\\\\n-       \\\\\\\"principalIdDisplayName\\\\\\\": \\\\\\\"external tenant administrators\\\\\\\",\\\\n-       \\\\\\\"roleDefinitionId\\\\\\\": \\\\\\\"b24988ac-6180-42a0-ab88-20f7382dd24c\\\\\\\"\\\\n-     }\\\\n-   ]\\\\n-   ```\\\\n+Choose the users or groups in your external tenant who can access the [Log Analytics workspace](/azure/azure-monitor/logs/log-analytics-workspace-overview). The selected users need at least the [Security Administrator](/entra/identity/role-based-access-control/permissions-reference#security-administrator) role to set up diagnostic settings.\\\\n \\\\n-After you deploy the template, it can take a few minutes (typically no more than five) for the resource projection to complete. You can verify the deployment in your =workforce tenant and get the details of the resource projection. For more information, see [View and manage service providers](/azure/lighthouse/how-to/view-manage-service-providers).\\\\n+Confirm your selection with the **Select** button. After you select the users or groups, assign a role to them. You can choose from the following roles:\\\\n \\\\n-## Step 4: External tenant configuration - select your subscription\\\\n+- **[Contributor](/azure/role-based-access-control/built-in-roles/privileged#contributor)**: Can read monitoring data and configuration.\\\\n+- **[Log Analytics Contributor](/azure/azure-monitor/logs/manage-access?tabs=portal#log-analytics-contributor)**: Can read and write monitoring data and configuration.\\\\n+- **[Monitoring Contributor](/azure/role-based-access-control/built-in-roles/monitor#monitoring-contributor)**: Can read all monitoring data and edit monitoring settings.\\\\n+- **Monitoring Policy Contributor**: Can manage security-related features, including viewing and managing security alerts and reports.\\\\n \\\\n-After you've deployed the template and waited a few minutes for the resource projection to complete, follow these steps to associate your subscription with your external tenant.\\\\n+<!---Check these roles!--->\\\\n+After you select the users or groups and assign a role, select **Next** to continue.\\\\n \\\\n-> [!NOTE]\\\\n-> On the **Portal settings | Directories + subscriptions** page, ensure that your external and workforce tenants are selected under **Current + delegated directories**.\\\\n-\\\\n-### Select your subscription\\\\n+  :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/select-users-and-roles.png\\\\\\\" alt-text=\\\\\\\"Screenshot that shows how to add users, groups, and roles.\\\\\\\":::\\\\n \\\\n-1. Sign out of the [Azure portal](https://portal.azure.com) and sign back in with your external tenant administrative account. This account must be a member of the security group you specified previously. Signing out and singing back in allows your session credentials to be refreshed in the next step.\\\\n-1. Select the **Settings** icon in the portal toolbar.\\\\n-1. On the **Portal settings | Directories + subscriptions** page, in the **Directory name** list,  find your workforce tenant directory that contains the Azure subscription and the _ExtIDMonitor_ resource group you created, and then select **Switch**.\\\\n-1. Verify that you've selected the correct directory and your Azure subscription is listed and selected in the **Default subscription filter**.\\\\n+#### Optional: Add tags to your Log Analytics workspace\\\\n \\\\n-:::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/default-subscription-filter.png\\\\\\\" alt-text=\\\\\\\"Screenshot of the default subscription filter.\\\\\\\":::\\\\n+You can add tags to your Log Analytics workspace. Tags are name/value pairs that help you categorize resources and view consolidated billing by applying the same tag to multiple resources and resource groups. For more information, see [Use tags to organize your Azure resources](/azure/azure-resource-manager/management/tag-resources).\\\\n \\\\n-### Configure diagnostic settings\\\\n+### Step 4: Review and create your Log Analytics workspace\\\\n \\\\n-Diagnostic settings define where logs and metrics for a resource should be sent. Possible destinations are:\\\\n+Review your configuration. If you need to make changes, use the **Back** button to return to the previous steps. If everything looks correct, select **Create** to set up the Log Analytics workspace and assign the selected users or groups the specified role. Setting up the Log Analytics workspace and assigning roles might take a few minutes, so don't close the browser window.\\\\n \\\\n-- [Azure storage account](/azure/azure-monitor/essentials/resource-logs#send-to-azure-storage)\\\\n-- [Event hubs](/azure/azure-monitor/essentials/resource-logs#send-to-azure-event-hubs) solutions\\\\n-- [Log Analytics workspace](/azure/azure-monitor/essentials/resource-logs#send-to-log-analytics-workspace)\\\\n+  :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/review-and-create.png\\\\\\\" alt-text=\\\\\\\"Screenshot that shows how to review and create your Log Analytics workspace.\\\\\\\":::\\\\n \\\\n-In this example, we use the Log Analytics workspace to create a dashboard. Follow the steps to configure [monitoring settings](/entra/identity/monitoring-health/overview-monitoring-health) for the external tenant activity logs:\\\\n+When the setup is complete, you see a confirmation message. Select **Done** and configure diagnostic settings to start sending logs and metrics to your Log Analytics workspace.\\\\n \\\\n-1. Sign in to the [Microsoft Entra admin center](https://entra.microsoft.com).\\\\n-1. If you have access to multiple tenants, use the **Settings** icon :::image type=\\\\\\\"icon\\\\\\\" source=\\\\\\\"media/common/admin-center-settings-icon.png\\\\\\\" border=\\\\\\\"false\\\\\\\"::: in the top menu and switch to your external tenant from the **Directories + subscriptions** menu. This account must be a member of the security group you specified previously.\\\\n-1. Browse to **Diagnostic settings** by navigating to **Entra ID** > **Monitoring & health**.\\\\n-1. If there are existing settings for the resource, you'll see a list of settings already configured. Either select **Add diagnostic setting** to add a new setting, or select **Edit settings** to edit an existing setting. Each setting can have no more than one of each of the destination types.\\\\n+  :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/successful-configuration.png\\\\\\\" alt-text=\\\\\\\"Screenshot that shows the setup completion message.\\\\\\\":::\\\\n \\\\n-    :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/diagnostic-settings-pane-enabled.png\\\\\\\" alt-text=\\\\\\\"Screenshot of the diagnostics settings.\\\\\\\":::\\\\n+## Configure diagnostic settings\\\\n \\\\n-1. Give your setting a name if it doesn't already have one.\\\\n-1. Select **AuditLogs** and **SignInLogs**.\\\\n-1. Select **Send to Log Analytics workspace**, and then:\\\\n-    1. Under **Subscription**, select your subscription. \\\\n-    2. Under **Log Analytics workspace**, select the name of the workspace you created earlier such as _ExtIDLogAnalytics_.\\\\n+[Diagnostic settings](/azure/azure-monitor/platform/diagnostic-settings?tabs=portal) enable you to collect [resource logs](/azure/azure-monitor/platform/resource-logs?tabs=log-analyticsd) and send [platform metrics](/azure/azure-monitor/reference/metrics-index) and the [activity log](/azure/azure-monitor/platform/activity-log?tabs=log-analytics) to different destinations. You can create up to five different diagnostic settings to send various logs and metrics to different destinations. Follow these steps to configure diagnostic settings in your external tenant.\\\\n \\\\n-1. Select **Save**.\\\\n+1. Select **Add settings** under **Add diagnostic settings**.\\\\n+1. If you select **Review** before adding settings, you can see the **Subscription** and **Resource Group** on the right hand side. These fields are read-only. To make changes, remove the existing service provider information and start the wizard again. If you're satisfied with the selection, select **Done** to continue to the next step. This step is optional.\\\\n \\\\n > [!NOTE]\\\\n-> It can take up to 15 minutes after an event is emitted for it to [appear in a Log Analytics workspace](/azure/azure-monitor/logs/data-ingestion-time). While you're waiting, it might be helpful to perform some actions to generate logs. For example, you could follow the [Get started guide](/entra/external-id/customers/quickstart-get-started-guide) to create some configurations and sign up a user.\\\\n+> If you select **Review** before adding settings, the **Subscription** and **Resource group** appear on the right-hand side. These fields are read-only. To make changes, remove the existing service provider information and restart the wizard.  \\\\n+Keep the window open while the background subscription check runs. If you close or refresh the window before the check finishes, you might need to restart the wizard from **Start setup**.\\\\n+\\\\n+  :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/add-diagnostic-settings.png\\\\\\\" alt-text=\\\\\\\"Screenshot that shows the Add diagnostic settings page.\\\\\\\" lightbox=\\\\\\\"media/how-to-azure-monitor/add-diagnostic-settings.png\\\\\\\":::\\\\n+\\\\n \\\\n-## Step 5: Workforce tenant configuration – visualize your data\\\\n+3. Select **Add diagnostic setting** to add a new setting or **Edit setting** to edit an existing one. You might need multiple diagnostic settings for a resource if you want to send data to multiple destinations of the same type.\\\\n+4. Give your setting a descriptive name.\\\\n+5. **Logs and metrics to route**: For logs, either choose a [category group](/azure/azure-monitor/platform/diagnostic-settings?tabs=portal#category-groups) or select the individual checkboxes for each category of data you want to send to the destinations specified later. The list of categories varies for each Azure service. Select **AllMetrics** if you want to collect platform metrics.\\\\n+6. **Destination details**: Select the checkbox for each destination that should be included in the diagnostic settings and then provide the details for each. If you select Log Analytics workspace as a destination, then you might need to specify the collection mode. See [Collection mode](/azure/azure-monitor/platform/resource-logs?tabs=log-analytics#collection-mode) for details.\\\\n \\\\n-Now you can configure your Log Analytics workspace to visualize your data and set up alerts. You can make these configurations in both your workforce and external tenant.\\\\n+## Visualize your data with log queries\\\\n+\\\\n+Once you configure your diagnostic settings and data flows into your Log Analytics workspace, use log queries to analyze and visualize your data. Log queries are written in Kusto Query Language (KQL) and can help you gain insights from the logs and metrics collected. You can make these configurations in both your workforce and external tenant.\\\\n \\\\n ### Create a query\\\\n \\\\n-Log queries help you to fully use the value of the data collected in Azure Monitor Logs. A powerful query language allows you to join data from multiple tables, aggregate large sets of data, and perform complex operations with minimal code. Virtually any question can be answered and analysis performed as long as the supporting data has been collected and you understand how to construct the right query. For more information, see [Get started with log queries in Azure Monitor](/azure/azure-monitor/logs/get-started-queries).\\\\n+Log queries help you get the most value from the data collected in Azure Monitor Logs. A powerful query language lets you join data from multiple tables, aggregate large sets of data, and perform complex operations with minimal code. You can answer virtually any question and perform analysis as long as you collect the supporting data and understand how to construct the right query. For more information, see [Get started with log queries in Azure Monitor](/azure/azure-monitor/logs/get-started-queries).\\\\n \\\\n 1. Sign in to the [Azure portal](https://portal.azure.com).\\\\n 1. If you have access to multiple tenants, select the **Settings** icon in the top menu to switch to your workforce tenant from the **Directories + subscriptions** menu.\\\\n 1. From **Log Analytics workspace** window, select **Logs**\\\\n-1. In the query editor, paste the following [Kusto Query Language](/azure/data-explorer/kusto/query/) query. This query shows policy usage by operation over the past x days. The default duration is set to 90 days (90d). Notice that the query is focused only on the operation where a token/code is issued by policy.\\\\n+1. In the query editor, paste the following [Kusto Query Language](/azure/data-explorer/kusto/query/) query. This query shows policy usage by operation over the past x days. The default duration is set to 90 days (90d). Notice that the query is focused only on the operation where a token or code is issued by policy.\\\\n \\\\n-   ```kusto\\\\n-   AuditLogs\\\\n-   | where TimeGenerated  > ago(90d)\\\\n-   | where OperationName contains \\\\\\\"issue\\\\\\\"\\\\n-   | extend  UserId=extractjson(\\\\\\\"$.[0].id\\\\\\\",tostring(TargetResources))\\\\n-   | extend Policy=extractjson(\\\\\\\"$.[1].value\\\\\\\",tostring(AdditionalDetails))\\\\n-   | summarize SignInCount = count() by Policy, OperationName\\\\n-   | order by SignInCount desc  nulls last\\\\n-   ```\\\\n+  ```kusto\\\\n+  AuditLogs\\\\n+  | where TimeGenerated  > ago(90d)\\\\n+  | where OperationName contains \\\\\\\"issue\\\\\\\"\\\\n+  | extend  UserId=extractjson(\\\\\\\"$.[0].id\\\\\\\",tostring(TargetResources))\\\\n+  | extend Policy=extractjson(\\\\\\\"$.[1].value\\\\\\\",tostring(AdditionalDetails))\\\\n+  | summarize SignInCount = count() by Policy, OperationName\\\\n+  | order by SignInCount desc  nulls last\\\\n+  ```\\\\n \\\\n-1. Select **Run**. The query results are displayed at the bottom of the screen.\\\\n-1. To save your query for later use, select **Save**.\\\\n+5. Select **Run**. The query results are displayed at the bottom of the screen.\\\\n+6. To save your query for later use, select **Save**.\\\\n \\\\n   :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/query-policy-usage.png\\\\\\\" alt-text=\\\\\\\"Screenshot of the Log Analytics log editor.\\\\\\\":::\\\\n \\\\n 7. Fill in the following details:\\\\n \\\\n-   - **Name** - Enter the name of your query.\\\\n-   - **Save as** - Select `query`.\\\\n-   - **Category** - Select `Log`.\\\\n+- **Name** - Enter the name of your query.\\\\n+- **Save as** - Select `query`.\\\\n+- **Category** - Select `Log`.\\\\n \\\\n 8. Select **Save**.\\\\n \\\\n You can also change your query to visualize the data by using the [render](/azure/data-explorer/kusto/query/renderoperator?pivots=azuremonitor) operator.\\\\n \\\\n ```kusto\\\\n-AuditLogs\\\\n-| where TimeGenerated  > ago(90d)\\\\n-| where OperationName contains \\\\\\\"issue\\\\\\\"\\\\n-| extend  UserId=extractjson(\\\\\\\"$.[0].id\\\\\\\",tostring(TargetResources))\\\\n-| extend Policy=extractjson(\\\\\\\"$.[1].value\\\\\\\",tostring(AdditionalDetails))\\\\n-| summarize SignInCount = count() by Policy\\\\n-| order by SignInCount desc  nulls last\\\\n-| render  piechart\\\\n-```\\\\n+  AuditLogs\\\\n+  | where TimeGenerated  > ago(90d)\\\\n+  | where OperationName contains \\\\\\\"issue\\\\\\\"\\\\n+  | extend  UserId=extractjson(\\\\\\\"$.[0].id\\\\\\\",tostring(TargetResources))\\\\n+  | extend Policy=extractjson(\\\\\\\"$.[1].value\\\\\\\",tostring(AdditionalDetails))\\\\n+  | summarize SignInCount = count() by Policy\\\\n+  | order by SignInCount desc  nulls last\\\\n+  | render  piechart\\\\n+  ```\\\\n \\\\n   :::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/how-to-azure-monitor/query-policy-usage-pie.png\\\\\\\" alt-text=\\\\\\\"Screenshot of the Log Analytics log editor pie chart.\\\\\\\":::\\\\n \\\\n ## Change the data retention period\\\\n \\\\n-Azure Monitor Logs are designed to scale and support collecting, indexing, and storing massive amounts of data per day from any source in your enterprise or deployed in Azure. By default, logs are retained for 30 days, but retention duration can be increased to up to two years. Learn how to [manage usage and costs with Azure Monitor Logs](/azure/azure-monitor/logs/cost-logs). After you select the pricing tier, you can [Change the data retention period](/azure/azure-monitor/logs/data-retention-configure).\\\\n+Azure Monitor Logs scale to support collecting, indexing, and storing massive amounts of data each day from any source in your enterprise or deployed in Azure. By default, logs are retained for 30 days, but you can increase the retention duration to up to two years. For more information, see [manage usage and costs with Azure Monitor Logs](/azure/azure-monitor/logs/cost-logs). After you select the pricing tier, you can [Change the data retention period](/azure/azure-monitor/logs/data-retention-configure).\\\\n \\\\n ## Disable monitoring data collection\\\\n \\\\n-To stop collecting logs to your Log Analytics workspace, delete the diagnostic settings you created. You'll continue to incur charges for retaining log data you've already collected into your workspace. If you no longer need the monitoring data you've collected, you can delete your Log Analytics workspace and the resource group you created for Azure Monitor. Deleting the Log Analytics workspace deletes all data in the workspace and prevents you from incurring other data retention charges.\\\\n+To stop collecting logs to your Log Analytics workspace, delete the diagnostic settings you created. You continue to incur charges for retaining log data you already collected into your workspace. If you no longer need the monitoring data you collected, you can delete your Log Analytics workspace and the resource group you created for Azure Monitor. Deleting the Log Analytics workspace deletes all data in the workspace and prevents you from incurring other data retention charges.\\\\n \\\\n-### Delete Log Analytics workspace and resource group\\\\n+## Using Microsoft Sentinel with External ID\\\\n \\\\n-1. Sign in to the [Azure portal](https://portal.azure.com).\\\\n-1. If you have access to multiple tenants, select the **Settings** icon in the top menu to switch to your workforce tenant from the **Directories + subscriptions** menu.\\\\n-1. Choose the resource group that contains the Log Analytics workspace. This example uses a resource group named _ExtIDMonitor_ and a Log Analytics workspace named _ExtIDLogAnalytics_.\\\\n-1. [Delete the Logs Analytics workspace](/azure/azure-monitor/logs/delete-workspace).\\\\n-1. Select the **Delete** button to delete the resource group.\\\\n+Once External ID logs from an external tenant are sent to a Log Analytics workspace in a workforce tenant, you can ingest them into Microsoft Sentinel for monitoring, incident rules, alerts, and workbooks. You must configure Sentinel from the workforce tenant, as direct setup from the external tenant isn't supported. To use Sentinel:\\\\n+\\\\n+1. Send logs to a Log Analytics workspace in a workforce tenant via Azure Monitor diagnostic settings. Direct configuration from the external tenant isn't supported.  \\\\n+\\\\n+1. In the Azure portal, add Microsoft Sentinel to the Log Analytics workspace. For more information, see [Onboard to Microsoft Sentinel](/azure/sentinel/quickstart-onboard?tabs=defender-portal#add-microsoft-sentinel-to-your-log-analytics-workspace).\\\\n+\\\\n+1. In the Defender Portal, open the Microsoft Sentinel Content Hub and install the Entra ID content pack.\\\\n+\\\\n+### Supported features\\\\n+\\\\n+- **Analytics & Alerts:**  Configure incident rules using prebuilt templates; triggered alerts appear correctly.\\\\n+\\\\n+- **Workbooks:**  Visualize and analyze collected logs using prebuilt workbooks.\\\\n+\\\\n+For more information, see the [Microsoft Sentinel Documentation](/azure/sentinel).\\\\n+\\\\n+These steps enable centralized monitoring, incident management, and visualization for External ID logs while using a supported, workforce-tenant setup.\\\\n \\\\n ## Related content\\\\n \\\\n-- [Use audit logs and access reviews](/entra/external-id/auditing-and-reporting)\\\\n+- [Use audit logs and access reviews](/entra/external-id/auditing-and-reporting)\\\\n\\\\\\\\ No newline at end of file\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"a69281ac02eb233cf64ee306a4a190777e4944e7\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/add-diagnostic-settings.png\\\",\\r\\n    \\\"status\\\": \\\"added\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fadd-diagnostic-settings.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fadd-diagnostic-settings.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fadd-diagnostic-settings.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"5c1e4b9ca44350fbce08e32e36bbe641bbde0f2a\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/azure-monitor-flow.png\\\",\\r\\n    \\\"status\\\": \\\"removed\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fazure-monitor-flow.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fazure-monitor-flow.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fazure-monitor-flow.png?ref=beb45e8624949a42532af1968603b26385ab1aae\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"3b44eecf796bfbf5456b20979ca376062dbfad8a\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/default-subscription-filter.png\\\",\\r\\n    \\\"status\\\": \\\"removed\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fdefault-subscription-filter.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fdefault-subscription-filter.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fdefault-subscription-filter.png?ref=beb45e8624949a42532af1968603b26385ab1aae\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"bacaac6ebc92f8ed0388fede77d5c72e33566653\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/diagnostic-settings-pane-enabled.png\\\",\\r\\n    \\\"status\\\": \\\"removed\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fdiagnostic-settings-pane-enabled.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fdiagnostic-settings-pane-enabled.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fdiagnostic-settings-pane-enabled.png?ref=beb45e8624949a42532af1968603b26385ab1aae\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"2a04362edd1755ac44d471102216ba6dbb3cd364\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/query-policy-usage-pie.png\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fquery-policy-usage-pie.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fquery-policy-usage-pie.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fquery-policy-usage-pie.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"bbc6409bdca119163625643b767feb30575789ae\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/query-policy-usage.png\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fquery-policy-usage.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fquery-policy-usage.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fquery-policy-usage.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"ae2facba98c7fce566bd1b02835b4ae51a83b100\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/resource-group-projection.png\\\",\\r\\n    \\\"status\\\": \\\"removed\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fresource-group-projection.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/beb45e8624949a42532af1968603b26385ab1aae/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fresource-group-projection.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fresource-group-projection.png?ref=beb45e8624949a42532af1968603b26385ab1aae\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"ba1448fcfd75420fbbde9dbd900c4bf1c1bcc2ea\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/review-and-create.png\\\",\\r\\n    \\\"status\\\": \\\"added\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Freview-and-create.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Freview-and-create.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Freview-and-create.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"a6ea2ea88f2e61cfc057ae0105d4e6ecfa9b00c1\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/select-subscription.png\\\",\\r\\n    \\\"status\\\": \\\"added\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fselect-subscription.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fselect-subscription.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fselect-subscription.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"ca8853de96cda491fa4e120dc87df638a47c667c\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/select-users-and-roles.png\\\",\\r\\n    \\\"status\\\": \\\"added\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fselect-users-and-roles.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fselect-users-and-roles.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fselect-users-and-roles.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"138a6e42c5989961e0bbfe8a7b48b6089842c7fc\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/sign-in-to-workforce.png\\\",\\r\\n    \\\"status\\\": \\\"added\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fsign-in-to-workforce.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fsign-in-to-workforce.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fsign-in-to-workforce.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"10128d0eb6e1543d33a2bf9843981ddbb335d2b6\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/start-set-up.png\\\",\\r\\n    \\\"status\\\": \\\"added\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fstart-set-up.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fstart-set-up.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fstart-set-up.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"c96441b0081d87cea1198e491d8e84cadfcb4b00\\\",\\r\\n    \\\"filename\\\": \\\"docs/external-id/customers/media/how-to-azure-monitor/successful-configuration.png\\\",\\r\\n    \\\"status\\\": \\\"added\\\",\\r\\n    \\\"additions\\\": 0,\\r\\n    \\\"deletions\\\": 0,\\r\\n    \\\"changes\\\": 0,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fsuccessful-configuration.png\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fsuccessful-configuration.png\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fexternal-id%2Fcustomers%2Fmedia%2Fhow-to-azure-monitor%2Fsuccessful-configuration.png?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"8aa198f7a812d6ea8bbc812de45b425e23f12334\\\",\\r\\n    \\\"filename\\\": \\\"docs/identity-platform/refresh-tokens.md\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 9,\\r\\n    \\\"deletions\\\": 4,\\r\\n    \\\"changes\\\": 13,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fidentity-platform%2Frefresh-tokens.md\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/39101aba7d2a32f6e1dbc97a2289108851967471/docs%2Fidentity-platform%2Frefresh-tokens.md\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fidentity-platform%2Frefresh-tokens.md?ref=39101aba7d2a32f6e1dbc97a2289108851967471\\\",\\r\\n    \\\"patch\\\": \\\"@@ -4,8 +4,7 @@ description: Learn about refresh tokens that are used in the Microsoft identity\\\\n author: cilwerner\\\\n manager: pmwongera\\\\n ms.author: cwerner\\\\n-ms.custom:\\\\n-ms.date: 05/14/2025\\\\n+ms.date: 11/05/2025\\\\n ms.reviewer: ludwignick\\\\n ms.service: identity-platform\\\\n \\\\n@@ -21,7 +20,13 @@ Refresh tokens are also used to acquire extra access tokens for other resources.\\\\n \\\\n ## Token lifetime\\\\n \\\\n-Refresh tokens have a longer lifetime than access tokens. The default lifetime for the refresh tokens is 24 hours for single page apps and 90 days for all other scenarios. Refresh tokens replace themselves with a fresh token upon every use. The Microsoft identity platform doesn't revoke old refresh tokens when used to fetch new access tokens. Securely delete the old refresh token after acquiring a new one. Refresh tokens need to be stored safely like access tokens or application credentials.\\\\n+Refresh tokens have a longer lifetime than access tokens. The default lifetime for the refresh tokens are as follows:\\\\n+ \\\\n+- **24 hours** for single-page applications.\\\\n+- **24 hours** for apps that use email one-time passcode authentication flow.\\\\n+- **90 days for** all other scenarios.\\\\n+\\\\n+Refresh tokens replace themselves with a fresh token upon every use. The Microsoft identity platform doesn't revoke old refresh tokens when used to fetch new access tokens. Securely delete the old refresh token after acquiring a new one. Refresh tokens need to be stored safely like access tokens or application credentials.\\\\n \\\\n > [!NOTE]\\\\n > Refresh tokens sent to a redirect URI registered as `spa` expire after 24 hours. Additional refresh tokens acquired using the initial refresh token carry over that expiration time, so apps must be prepared to rerun the authorization code flow using an interactive authentication to get a new refresh token every 24 hours. Users don't have to enter their credentials and usually don't even see any related user experience, just a reload of your application. The browser must visit the sign-in page in a top-level frame to show the login session. This is due to [privacy features in browsers that block third party cookies](reference-third-party-cookies-spas.md).\\\\n@@ -55,4 +60,4 @@ The server can revoke refresh tokens because of a change in credentials, user ac\\\\n - [Primary refresh tokens](~/identity/devices/concept-primary-refresh-token.md)\\\\n - [Access tokens in the Microsoft identity platform](access-tokens.md)\\\\n - [Invalidate refresh token](/powershell/module/microsoft.graph.beta.users.actions/invoke-mgbetainvalidatealluserrefreshtoken?view=graph-powershell-beta&preserve-view=true)\\\\n-- [Configurable token lifetimes](configurable-token-lifetimes.md)\\\\n+- [Configurable token lifetimes](configurable-token-lifetimes.md)\\\\n\\\\\\\\ No newline at end of file\\\"\\r\\n  }\\r\\n]. Please summarise it in a few sentences, using UK grammar and ensure the response is formatted for markdown. Do not start the response with here is summary.\"}",
    "Response": "Here's a summary of the provided commit files:\n\nThe main change involves a significant revision to the \"Set up Azure Monitor in external tenants\" documentation. The update streamlines the setup process by introducing a wizard accessible from either the \"Diagnostic settings\" or \"Security Store\" pages. It also clarifies prerequisites, role requirements, and the integration with Microsoft Sentinel. Additionally, minor adjustments were made to the \"Refresh tokens\" documentation, updating the default lifetime for refresh tokens in single-page applications and email one-time passcode authentication flows.",
    "Model": "google:gemini-2.5-flash-lite",
    "Provider": "google",
    "ModelName": "gemini-2.5-flash-lite",
    "Timestamp": "2025-11-06T14:00:45.7592139+00:00"
  },
  "files": [
    {
      "filename": "docs/external-id/customers/how-to-azure-monitor.md",
      "status": "modified",
      "additions": 117,
      "deletions": 158
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/add-diagnostic-settings.png",
      "status": "added",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/azure-monitor-flow.png",
      "status": "removed",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/default-subscription-filter.png",
      "status": "removed",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/diagnostic-settings-pane-enabled.png",
      "status": "removed",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/query-policy-usage-pie.png",
      "status": "modified",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/query-policy-usage.png",
      "status": "modified",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/resource-group-projection.png",
      "status": "removed",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/review-and-create.png",
      "status": "added",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/select-subscription.png",
      "status": "added",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/select-users-and-roles.png",
      "status": "added",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/sign-in-to-workforce.png",
      "status": "added",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/start-set-up.png",
      "status": "added",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/external-id/customers/media/how-to-azure-monitor/successful-configuration.png",
      "status": "added",
      "additions": 0,
      "deletions": 0
    },
    {
      "filename": "docs/identity-platform/refresh-tokens.md",
      "status": "modified",
      "additions": 9,
      "deletions": 4
    }
  ]
}