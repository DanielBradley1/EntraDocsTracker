{
  "sha": "3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3",
  "url": "https://github.com/MicrosoftDocs/entra-docs/commit/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3",
  "author": "learn-build-service-prod[bot]",
  "email": "113403604+learn-build-service-prod[bot]@users.noreply.github.com",
  "date": "2025-09-24T17:08:39Z",
  "message": "Merge pull request #9795 from MicrosoftDocs/main\n\nAuto Publish – main to live - 2025-09-24 17:06 UTC",
  "ai_summary": {
    "Messages": "{\"role\":\"user\",\"content\":\"The following is the commit files that have changed: [\\r\\n  {\\r\\n    \\\"sha\\\": \\\"7bc94bf6ebac134ac53888072cb7e050cb00255d\\\",\\r\\n    \\\"filename\\\": \\\"docs/identity/authentication/concept-sspr-policy.md\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 22,\\r\\n    \\\"deletions\\\": 1,\\r\\n    \\\"changes\\\": 23,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fauthentication%2Fconcept-sspr-policy.md\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fauthentication%2Fconcept-sspr-policy.md\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fidentity%2Fauthentication%2Fconcept-sspr-policy.md?ref=3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3\\\",\\r\\n    \\\"patch\\\": \\\"@@ -115,7 +115,28 @@ A two-gate policy applies in the following circumstances:\\\\n \\\\n * Microsoft Entra Connect synchronizes identities from your on-premises directory\\\\n \\\\n-You can disable the use of SSPR for administrator accounts using the [Update-MgPolicyAuthorizationPolicy](/powershell/module/microsoft.graph.identity.signins/update-mgpolicyauthorizationpolicy) PowerShell cmdlet. The `-AllowedToUseSspr:$true|$false` parameter enables/disables SSPR for administrators. Policy changes to enable or disable SSPR for administrator accounts can take up to 60 minutes to take effect. \\\\n+You can disable the use of SSPR for administrator accounts by setting the value of the `AllowedToUseSspr` property on the tenant authorization policy to `false`. Policy changes to enable or disable SSPR for administrator accounts can take up to 60 minutes to take effect.\\\\n+\\\\n+# [PowerShell](#tab/ms-powershell)\\\\n+\\\\n+[Update-MgPolicyAuthorizationPolicy](/powershell/module/microsoft.graph.identity.signins/update-mgpolicyauthorizationpolicy)\\\\n+\\\\n+```powershell\\\\n+Connect-MgGraph -Scopes Policy.ReadWrite.Authorization\\\\n+Update-MgPolicyAuthorizationPolicy -AllowedToUseSspr:$false\\\\n+```\\\\n+\\\\n+# [Microsoft Graph](#tab/ms-graph)\\\\n+\\\\n+[Update authorizationPolicy](/graph/api/authorizationpolicy-update)\\\\n+\\\\n+```http\\\\n+PATCH https://graph.microsoft.com/v1.0/policies/authorizationPolicy\\\\n+{\\\\n+  \\\\\\\"allowedToUseSSPR\\\\\\\":false\\\\n+}\\\\n+```\\\\n+---\\\\n \\\\n ### Exceptions\\\\n \\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"60ddeb5c04cbd9449bc66938dc56db094f873577\\\",\\r\\n    \\\"filename\\\": \\\"docs/identity/authentication/how-to-unlock-users-for-mandatory-multifactor-authentication.md\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 15,\\r\\n    \\\"deletions\\\": 3,\\r\\n    \\\"changes\\\": 18,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fauthentication%2Fhow-to-unlock-users-for-mandatory-multifactor-authentication.md\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fauthentication%2Fhow-to-unlock-users-for-mandatory-multifactor-authentication.md\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fidentity%2Fauthentication%2Fhow-to-unlock-users-for-mandatory-multifactor-authentication.md?ref=3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3\\\",\\r\\n    \\\"patch\\\": \\\"@@ -166,7 +166,7 @@ function Set-TenantSettingsMFAPostponement {\\\\n     # Get tokens\\\\n     Write-Host \\\\\\\"Fetching necessary authorization tokens...\\\\\\\"\\\\n     try {\\\\n-        $armToken = (Get-AzAccessToken -ResourceUrl \\\\\\\"https://management.azure.com/\\\\\\\").Token\\\\n+        $armToken = Get-StringFromSecureString -secureString (Get-AzAccessToken -ResourceUrl \\\\\\\"https://management.azure.com/\\\\\\\").Token\\\\n         if ($null -eq $armToken) {\\\\n             Write-Host \\\\\\\"Failed to fetch an authorization token for Azure Resource Manager. Make sure you run: Connect-AzAccount -TenantId '<your tenant id>'\\\\\\\" -ForegroundColor Red\\\\n             return\\\\n@@ -180,7 +180,7 @@ function Set-TenantSettingsMFAPostponement {\\\\n     }\\\\n \\\\n     try {\\\\n-        $coreToken = (Get-AzAccessToken -ResourceUrl \\\\\\\"https://management.core.windows.net/\\\\\\\").Token\\\\n+        $coreToken = Get-StringFromSecureString -secureString (Get-AzAccessToken -ResourceUrl \\\\\\\"https://management.core.windows.net/\\\\\\\").Token\\\\n         if ($null -eq $coreToken) {\\\\n             Write-Host \\\\\\\"Failed to fetch an authorization token for Azure Resource Manager core. Make sure you run: Connect-AzAccount -TenantId '<your tenant id>'\\\\\\\" -ForegroundColor Red\\\\n             return\\\\n@@ -429,7 +429,7 @@ function Remove-ElevatedAccess {\\\\n     Write-Host \\\\\\\"Refreshing authorization tokens...\\\\\\\"\\\\n     Start-Sleep -Seconds 3\\\\n     try {\\\\n-        $coreToken = (Get-AzAccessToken -ResourceUrl \\\\\\\"https://management.core.windows.net/\\\\\\\").Token\\\\n+        $coreToken = Get-StringFromSecureString -secureString (Get-AzAccessToken -ResourceUrl \\\\\\\"https://management.core.windows.net/\\\\\\\").Token\\\\n         if ($null -eq $coreToken) {\\\\n             Write-Host \\\\\\\"Failed to fetch an authorization token for Azure Resource Manager core. You will need to manually delete your elevated status.\\\\\\\" -ForegroundColor Red\\\\n             return\\\\n@@ -484,6 +484,18 @@ function Delete-Elevated-Access {\\\\n     }\\\\n }\\\\n \\\\n+function Get-StringFromSecureString {\\\\n+    param (\\\\n+        [System.Security.SecureString] $secureString\\\\n+    )\\\\n+    \\\\n+    $ptr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString)\\\\n+    $plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringBSTR($ptr)\\\\n+    [System.Runtime.InteropServices.Marshal]::ZeroFreeBSTR($ptr)\\\\n+    \\\\n+    return $plainText\\\\n+}\\\\n+\\\\n function Decode-JwtPayload {\\\\n     param (\\\\n         [string]$Jwt\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"f357c43713cd684ce9acea5a7015319ad16e4db2\\\",\\r\\n    \\\"filename\\\": \\\"docs/identity/authentication/kerberos.md\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 176,\\r\\n    \\\"deletions\\\": 149,\\r\\n    \\\"changes\\\": 325,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fauthentication%2Fkerberos.md\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fauthentication%2Fkerberos.md\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fidentity%2Fauthentication%2Fkerberos.md?ref=3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3\\\",\\r\\n    \\\"patch\\\": \\\"@@ -1,6 +1,6 @@\\\\n ---\\\\n title: Introduction to Microsoft Entra Kerberos\\\\n-description: Overview of Microsoft Entra Kerberos\\\\n+description: Get an overview of the Microsoft Entra Kerberos protocol.\\\\n author: barclayn\\\\n manager: pmwongera\\\\n ms.service: entra-id\\\\n@@ -14,234 +14,261 @@ ms.reviewer: Vimala\\\\n \\\\n # Introduction to Microsoft Entra Kerberos\\\\n \\\\n-**Microsoft Entra Kerberos** is a cloud-native authentication protocol designed to bridge hybrid identity scenarios, enabling secure access to both cloud and on-premises resources. It extends traditional Kerberos capabilities into the Microsoft Entra ecosystem, allowing organizations to modernize their identity infrastructure without sacrificing compatibility with legacy systems. It also enables seamless single sign-on (SSO) to on-premises resources for users authenticated with modern credentials like Windows Hello for Business or FIDO2 security keys.\\\\n+Microsoft Entra Kerberos is a cloud-native authentication protocol that bridges hybrid identity scenarios by enabling secure access to both cloud and on-premises resources. It extends traditional Kerberos capabilities into the Microsoft Entra ecosystem, so that organizations can modernize their identity infrastructure without sacrificing compatibility with legacy systems. It also enables seamless single sign-on (SSO) to on-premises resources for users authenticated with modern credentials like Windows Hello for Business or FIDO2 security keys.\\\\n \\\\n-Microsoft Entra Kerberos was introduced in 2021 to help bridge the gap between legacy, on-premises authentication protocols, and modern cloud identity.\\\\n-In practice, Microsoft Entra Kerberos turns Microsoft Entra ID into a cloud-based Key Distribution Center (KDC) for Kerberos authentication. This capability allows Microsoft Entra ID to issue Kerberos tickets for users, extending traditional Kerberos authentication beyond on-premises Active Directory. \\\\n+Microsoft Entra Kerberos was introduced in 2021 to help bridge the gap between legacy on-premises authentication protocols and modern cloud identity. In practice, Microsoft Entra Kerberos turns Microsoft Entra ID into a cloud-based Key Distribution Center (KDC) for Kerberos authentication. This capability allows Microsoft Entra ID to issue Kerberos tickets for users, extending traditional Kerberos authentication beyond on-premises Active Directory.\\\\n \\\\n-In a hybrid scenario, where accounts exist on-premises Active Directory Domain Services (AD DS) and those users are synchronized to Microsoft Entra ID, Microsoft Entra Kerberos plays a crucial role. It enables these hybrid users to authenticate to cloud and on-premises resources using Kerberos without needing direct line of sight to domain controllers. For example, if a Microsoft Entra ID–joined Windows client accesses a file share or application over the internet, Microsoft Entra ID can issue the necessary Kerberos tickets on behalf of the on-premises Active Directory environment.\\\\n+In a hybrid scenario, where accounts exist in on-premises Active Directory Domain Services (AD DS) and those users are synchronized to Microsoft Entra ID, Microsoft Entra Kerberos plays a crucial role. It enables these hybrid users to authenticate to cloud and on-premises resources by using Kerberos without needing a direct line of sight to domain controllers. For example, if a Microsoft Entra ID-joined Windows client accesses a file share or application over the internet, Microsoft Entra ID can issue the necessary Kerberos tickets on behalf of the on-premises Active Directory environment.\\\\n \\\\n+For more information about Kerberos in Windows, see [Kerberos authentication overview in Windows Server](/windows-server/security/kerberos/kerberos-authentication-overview).\\\\n \\\\n-> [!NOTE]\\\\n-> For more information about Kerberos in Windows, see [Kerberos authentication overview](/windows-server/security/kerberos/kerberos-authentication-overview).\\\\n+## Hybrid identity\\\\n \\\\n-## Hybrid Identity \\\\n+Currently, Microsoft Entra Kerberos works only with hybrid identities.\\\\n \\\\n-A hybrid identity refers to a user identity that exists both in an on-premises Active Directory (AD DS) and in Microsoft Entra ID. These identities are synchronized using tools like Microsoft Entra Connect, allowing users to access both cloud-based and on-premises resources with a single set of credentials. This setup enables seamless authentication and single sign-on (SSO) experiences across environments. It is ideal for organizations transitioning to the cloud while maintaining legacy infrastructure. \\\\n+A hybrid identity refers to a user identity that exists both in on-premises AD DS and in Microsoft Entra ID. These identities are synchronized through tools like Microsoft Entra Connect, so users can access both cloud-based and on-premises resources by using a single set of credentials.\\\\n \\\\n->[!IMPORTANT]\\\\n-> Currently, Microsoft Entra Kerberos only works with hybrid identities.\\\\n+This setup enables seamless authentication and SSO experiences across environments. It's ideal for organizations that want to transition to the cloud while maintaining legacy infrastructure.\\\\n \\\\n ## Key features and benefits\\\\n \\\\n-**Seamless Hybrid authentication**: Microsoft Entra Kerberos allows users whose accounts reside in on-premises Active Directory Domain Services (AD DS) and are synchronized to Microsoft Entra ID to authenticate across cloud and on-premises resources. It reduces and in some cases eliminates the need for direct connectivity to domain controllers. For example, when a Microsoft Entra ID-joined Windows client accesses a file share or application over the internet, Entra ID can issue the necessary Kerberos tickets as a KDC associated with the resource.\\\\n+**Seamless hybrid authentication**: Microsoft Entra Kerberos allows users whose accounts reside in on-premises AD DS and are synchronized to Microsoft Entra ID to authenticate across cloud and on-premises resources. It reduces (and in some cases, eliminates) the need for direct connectivity to domain controllers.\\\\n \\\\n-**Enhanced security with modern credentials support**: Users can sign in using passwordless methods such as Windows Hello for Business or FIDO2 security keys yet still access on-premises resources protected by Kerberos. Enables multifactor and password-less authentication, reducing risks associated with password theft and phishing attacks.\\\\n+For example, when a Microsoft Entra ID-joined Windows client accesses a file share or application over the internet, Microsoft Entra ID can issue the necessary Kerberos tickets as a KDC associated with the resource.\\\\n \\\\n-**Simplified Hybrid join**: Microsoft Entra Kerberos supports hybrid join scenarios without requiring ADFS or Microsoft Entra Connect sync. This is ideal for non-persistent virtual desktop infrastructure (VDI), disconnected forests, and Azure Virtual Desktop.\\\\n+**Enhanced security with modern credentials support**: Users can sign in by using passwordless methods such as Windows Hello for Business or FIDO2 security keys, yet still access on-premises resources that have Kerberos protections. This ability enables multifactor authentication (MFA) and passwordless authentication to reduce the risks associated with password theft and phishing attacks.\\\\n \\\\n-**Secure ticket exchange**: Microsoft Entra Kerberos uses a secure Ticket Granting Ticket (TGT) exchange model.\\\\n+**Simplified hybrid join**: Microsoft Entra Kerberos supports hybrid join scenarios without requiring Active Directory Federation Services (AD FS) or Microsoft Entra Connect Sync. This support is ideal for nonpersistent virtual desktop infrastructure, disconnected forests, and Azure Virtual Desktop.\\\\n \\\\n-**Scalable group memberships**: Addresses traditional Kerberos limitations with large or dynamic group memberships, improving reliability and user experience. In scenarios involving large groups of users, performance is optimized through automatic load distribution across all domain controllers (DCs) within a site. For deployments in Azure Virtual Desktop (AVD) environments, we recommend ensuring that sufficient DCs are available and geographically close to the environment to maintain responsiveness.\\\\n+**Secure ticket exchange**: Microsoft Entra Kerberos uses a Ticket Granting Ticket (TGT) exchange model for enhanced security.\\\\n \\\\n+**Scalable group memberships**: Microsoft Entra Kerberos addresses traditional Kerberos limitations with large or dynamic group memberships to improve reliability and user experience. In scenarios that involve large groups of users, performance is optimized through automatic load distribution across all domain controllers (DCs) within a site. For deployments in Azure Virtual Desktop environments, we recommend ensuring that sufficient DCs are available and geographically close to the environment, to maintain responsiveness.\\\\n \\\\n ## How Microsoft Entra Kerberos works\\\\n \\\\n-**Microsoft Entra Kerberos** allows your Microsoft Entra ID tenant to operate as a dedicated Kerberos realm alongside your existing on-premises Active Directory realm. When a user signs in to a Windows device that is either Microsoft Entra ID‑joined or hybrid joined, the device authenticates with Microsoft Entra ID and receives a [Primary Refresh Token](../devices/concept-primary-refresh-token.md). In addition to the PRT, Entra ID issues a Cloud Ticket Granting Ticket (TGT) for the realm KERBEROS.MICROSOFTONLINE.COM, a partial TGT to access on-premises resources. In this model, Microsoft Entra ID acts as the Key Distribution Center (KDC), facilitating secure and seamless authentication.\\\\n+Microsoft Entra Kerberos allows your Microsoft Entra ID tenant to operate as a dedicated Kerberos realm alongside your existing on-premises Active Directory realm. When a user signs in to a Windows device that's either Microsoft Entra ID joined or hybrid joined, the device authenticates with Microsoft Entra ID and receives a [Primary Refresh Token (PRT)](../devices/concept-primary-refresh-token.md).\\\\n+\\\\n+In addition to the PRT, Microsoft Entra ID issues a Cloud TGT for the realm `KERBEROS.MICROSOFTONLINE.COM`. This is a partial TGT to access on-premises resources. In this model, Microsoft Entra ID acts as the KDC to facilitate seamless authentication.\\\\n \\\\n ## Authentication flow\\\\n \\\\n-### 1. User authentication:\\\\n-- The user signs into a Windows 10 (2004+) or Windows 11 device that is either Microsoft Entra joined or hybrid joined.\\\\n-- The Local Security Authority (LSA) uses the Cloud Authentication Provider (CloudAP) to authenticate via OAuth to Microsoft Entra ID.\\\\n+### 1. User authentication\\\\n+\\\\n+The user signs in to a Windows 10 (2004 or later) or Windows 11 device that's either Microsoft Entra joined or hybrid joined.\\\\n+\\\\n+The Local Security Authority (LSA) uses the Cloud Authentication Provider (CloudAP) to authenticate via OAuth to Microsoft Entra ID.\\\\n+\\\\n+### 2. Token issuance\\\\n+\\\\n+Upon successful authentication, Microsoft Entra ID issues a PRT that contains user and device information. Alongside the PRT, Microsoft Entra ID issues a Cloud TGT for the realm `KERBEROS.MICROSOFTONLINE.COM`.\\\\n+\\\\n+Microsoft Entra ID also issues a partial TGT that contains the user's security identifier (SID) but no group claims. This partial TGT is not sufficient for direct access to on-premises resources.\\\\n \\\\n-### 2. Token Issuance\\\\n-- Upon successful authentication, Microsoft Entra ID issues a Primary Refresh Token (PRT) containing user and device information.\\\\n-- Alongside the PRT, a Cloud Ticket Granting Ticket (Cloud TGT) is issued for the realm KERBEROS.MICROSOFTONLINE.COM, which acts as a cloud-based Kerberos Distribution Center (KDC).\\\\n-- Entra ID also issues a Partial TGT containing the user’s SID (Security Identifier) but no group claims. This Partial TGT is not sufficient for direct access to on-prem resources.\\\\n+#### Cloud TGT issuance\\\\n \\\\n-#### Cloud TGT issuance:\\\\n+Microsoft Entra ID acts as a KDC for cloud resources by issuing a Cloud TGT to the client when appropriate. The client recognizes the Microsoft Entra ID tenant as a separate Kerberos realm for cloud resources, and the TGT is stored in the client's Kerberos ticket cache.\\\\n \\\\n-Microsoft Entra ID acts as a Key Distribution Center (KDC) for cloud resources, issuing a Cloud Ticket Granting Ticket (Cloud TGT) to the client when appropriate. The client recognizes the Microsoft Entra ID tenant as a separate Kerberos realm for cloud resources and the TGT is stored in the client's Kerberos ticket cache.\\\\n+The Cloud TGT that Microsoft Entra ID issues:\\\\n \\\\n-Cloud TGT issued by Microsoft Entra ID\\\\n-- is for the realm KERBEROS.MICROSOFTONLINE.COM. \\\\n-- enables access to cloud-based resources such as Azure Files, Azure SQL, and other services integrated with Entra Kerberos. - \\\\n-- contains authorization data specific to cloud services and used directly to request Kerberos service tickets for cloud resources. \\\\n-- always issued when a user signs into a Windows device with supported credentials (e.g., WHfB, FIDO2).\\\\n-- No dependency on on-premises domain controllers.\\\\n+- Is for the realm `KERBEROS.MICROSOFTONLINE.COM`.\\\\n+- Enables access to cloud-based resources such as Azure Files, Azure SQL, and other services that are integrated with Microsoft Entra Kerberos.\\\\n+- Contains authorization data that's specific to cloud services and is used directly to request Kerberos service tickets for cloud resources.\\\\n+- Is always issued when a user signs in to a Windows device by using supported credentials (for example, Windows Hello for Business or FIDO2).\\\\n+- Has no dependency on on-premises domain controllers.\\\\n \\\\n->[!NOTE]\\\\n+> [!NOTE]\\\\n > The Cloud TGT isn't a replacement for the on-premises TGT. It's another ticket that allows access to cloud resources. The on-premises TGT is still required for accessing on-premises resources.\\\\n \\\\n-#### Partial TGT Issuance for On-Prem Access\\\\n+#### Partial TGT issuance for on-premises access\\\\n+\\\\n+These prerequisites apply:\\\\n \\\\n-**Prerequisites** \\\\n-- Users must be synchronized from on-premises Active Directory to Microsoft Entra ID using Entra Connect.\\\\n-- A Kerberos Server Object must exist in the on-prem AD and be synchronized to Entra ID. This object allows Entra ID to issue Partial TGTs that can be redeemed by on-prem domain controllers.\\\\n-- Devices must be running Windows 10 (2004+) or Windows 11.\\\\n-- Devices should be Entra joined or hybrid joined.\\\\n-- Windows Hello for Business (WHfB) or FIDO2 authentication methods are recommended for optimal integration.\\\\n+- Users must be synchronized from on-premises Active Directory to Microsoft Entra ID via Microsoft Entra Connect.\\\\n+- A Kerberos server object must exist in on-premises Active Directory and be synchronized to Microsoft Entra ID. This object allows Microsoft Entra ID to issue partial TGTs that on-premises domain controllers can redeem.\\\\n+- Devices must be running Windows 10 (2004 or later) or Windows 11.\\\\n+- Devices should be Microsoft Entra joined or hybrid joined.\\\\n+- We recommend Windows Hello for Business or FIDO2 authentication methods for optimal integration.\\\\n - On-premises domain controllers must be patched to support Kerberos Cloud Trust.\\\\n-- Ensure line-of-sight between client devices and domain controllers for ticket exchange.\\\\n+- Ensure line of sight between client devices and domain controllers for ticket exchange.\\\\n+\\\\n+If the user signs in by using a passwordless method (such as FIDO2 or Windows Hello for Business) on devices with Windows 10 (2004 or later) or Windows 11, Microsoft Entra ID issues a partial TGT for the user's on-premises Active Directory domain. This partial TGT contains the user's SID but no authorization data.\\\\n \\\\n-If the user signs in with a password-less method (such as FIDO2 or Windows Hello for Business) on devices with Windows 10 (2004+) or Windows 11, Microsoft Entra ID issues a Partial Ticket Granting Ticket (Partial TGT) for the user's on-premises Active Directory (AD) domain. This Partial TGT contains the user's Security Identifier (SID) but no authorization data.\\\\n+The partial TGT that Microsoft Entra ID issues:\\\\n \\\\n-Partial TGT issued by Microsoft Entra ID\\\\n-- enables access to on-premises resources by acting as a bridge between Entra ID and Active Directory.\\\\n-- contains limited data (e.g., user SID) and no group claims and is not sufficient on its own to access on-prem resources.\\\\n-- only issued if the environment is configured to support it (e.g., hybrid identity setup, Entra Kerberos server object in AD).\\\\n-- must be exchanged with an on-premises AD domain controller for a full TGT that includes group memberships and other access control data. The Partial TGT must be exchanged with a domain controller to gain full authorization information which is then used to access resources like SMB shares or SQL servers.\\\\n+- Enables access to on-premises resources by acting as a bridge between Microsoft Entra ID and Active Directory.\\\\n+- Contains limited data (for example, the user's SID) and no group claims. It's not sufficient on its own to access on-premises resources.\\\\n+- Is issued only if the environment is configured to support it. For example, you have a hybrid identity setup and a Microsoft Entra Kerberos server object in Active Directory.\\\\n+- Must be exchanged with an on-premises Active Directory domain controller for a full TGT that includes group memberships and other access control data. The partial TGT must be exchanged with a domain controller to gain full authorization information. This information is then used to access resources like Server Message Block (SMB) shares or SQL servers.\\\\n \\\\n #### Microsoft Entra Kerberos TGT and Active Directory access control\\\\n-Possessing an Microsoft Entra Kerberos Ticket Granting Ticket (TGT) for a user's on-premises Active Directory (AD) domain does not automatically grant access to a full AD TGT. In Microsoft Entra Kerberos, the Azure AD Read-Only Domain Controller object’s allow and deny lists are used to control which users are permitted to receive Partial TGTs from Entra ID for on-premises resource access. This mechanism is critical for limiting exposure and enforcing security boundaries, especially in hybrid environments where Entra ID issues Partial TGTs that must be redeemed with on-prem AD domain controllers for a full TGT.\\\\n \\\\n-To complete the exchange, the user must be listed in the reveal credentials allowlist on the Azure AD Read-Only Domain Controller (RODC) object and not in the blocklist. \\\\n+Possessing a Microsoft Entra Kerberos TGT for a user's on-premises Active Directory domain does not automatically grant access to a full Active Directory TGT.\\\\n+\\\\n+Microsoft Entra Kerberos uses the Read-Only Domain Controller (RODC) object's allow list and block list to control which users can receive partial TGTs from Microsoft Entra ID for on-premises resource access. This mechanism is critical for limiting exposure and enforcing security boundaries. This mechanism is especially critical in hybrid environments where Microsoft Entra ID issues partial TGTs that must be redeemed with on-premises Active Directory domain controllers for a full TGT.\\\\n+\\\\n+To complete the exchange, the user must be listed in the allow list on the RODC object and not in the block list.\\\\n+\\\\n+:::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/kerberos/kerberos-account.png\\\\\\\" alt-text=\\\\\\\"Screenshot of user account properties in Active Directory.\\\\\\\" lightbox=\\\\\\\"media/kerberos/kerberos-account.png\\\\\\\":::\\\\n \\\\n-:::image type=\\\\\\\"content\\\\\\\" source=\\\\\\\"media/kerberos/kerberos-account.png\\\\\\\" alt-text=\\\\\\\"Screenshot of a user account properties in Active Directory.\\\\\\\" lightbox=\\\\\\\"media/kerberos/kerberos-account.png\\\\\\\":::\\\\n-    \\\\n-During the exchange process, where a partial Microsoft Entra Kerberos TGT is converted into a full AD TGT these lists are evaluated to determine access eligibility. If the user is on the allow list, the full TGT is issued. If the user is on the deny list, the request is rejected, and authentication fails.\\\\n+During the exchange process, a partial Microsoft Entra Kerberos TGT is converted into a full Active Directory TGT. Microsoft Entra ID evaluates the lists to determine access eligibility. If the user is in the allow list, Microsoft Entra ID issues the full TGT. If the user is in the block list, Microsoft Entra ID rejects the request and authentication fails.\\\\n \\\\n-As a best practice, the default configuration should be set to Deny, with explicit Allow permissions granted only to groups authorized to use Microsoft Entra Kerberos.\\\\n-    \\\\n->[!IMPORTANT]\\\\n-> The partial TGT is only recognized by on-premises Active Directory. Therefore, having access to a partial TGT doesn't provide access to other resources outside of AD.\\\\n+As a best practice, set the default configuration to **Deny**. Grant explicit **Allow** permissions only to groups that are authorized to use Microsoft Entra Kerberos.\\\\n \\\\n+> [!IMPORTANT]\\\\n+> Only on-premises Active Directory recognizes the partial TGT. Having access to a partial TGT doesn't provide access to resources outside Active Directory.\\\\n \\\\n-#### Realm mapping and Entra tenant info\\\\n+#### Realm mapping\\\\n \\\\n-**Realm mapping**\\\\n+Realm mapping is the mechanism that allows Windows clients to determine which Kerberos realm to contact when a user is accessing a resource. This mechanism is especially important when an organization uses both on-premises Active Directory and Microsoft Entra ID in the same environment.\\\\n \\\\n-Realm mapping is the mechanism that allows Windows clients to determine which Kerberos realm to contact when accessing a resource, especially important when both on-premises Active Directory and Microsoft Entra ID are used in the same environment.\\\\n+Windows uses the namespace of the service (for example, `*.file.core.windows.net`) to decide whether to contact Active Directory or Microsoft Entra ID for a Kerberos ticket. Because both cloud and on-premises services might share the same namespace, Windows can't distinguish them automatically.\\\\n \\\\n-Windows uses the namespace of the service (e.g., *.file.core.windows.net) to decide whether to contact Active Directory or Entra ID for a Kerberos ticket. Since both cloud and on-prem services may share the same namespace, Windows cannot distinguish them automatically. \\\\n+To resolve this situation, admins configure mappings of host name to Kerberos realm via:\\\\n \\\\n-To resolve this, admins configure host name-to-Kerberos realm mappings via:\\\\n-- Group Policy: Computer Configuration > Administrative Templates > System > Kerberos > Define host name-to-Kerberos realm mappings\\\\n-- Intune Policy CSP: Kerberos/HostToRealm\\\\n+- Group Policy: **Computer Configuration** > **Administrative Templates** > **System** > **Kerberos** > **Define host name-to-Kerberos realm mappings**\\\\n+- Intune Policy configuration service provider (CSP): **Kerberos/HostToRealm**\\\\n \\\\n-Example mapping: contoso.com (.file.core.windows.net → KERBEROS.MICROSOFTONLINE.COM)\\\\n+An example mapping for contoso.com is `.file.core.windows.net` to `KERBEROS.MICROSOFTONLINE.COM`. This mapping tells Windows to use Microsoft Entra Kerberos for specific Azure Files instances, while defaulting others to on-premises Active Directory.\\\\n \\\\n-This tells Windows to use Entra Kerberos for specific Azure Files instances, while defaulting others to on-premises AD.\\\\n+#### Azure tenant information in Microsoft Entra Kerberos\\\\n \\\\n-**Azure Tenant Information in Entra Kerberos**\\\\n-Microsoft Entra ID acts as a Kerberos Distribution Center (KDC) for cloud resources. It maintains tenant-specific configurations that guide how Kerberos tickets are issued and validated.\\\\n+Microsoft Entra ID acts as a KDC for cloud resources. It maintains tenant-specific configurations that guide how Kerberos tickets are issued and validated:\\\\n \\\\n-- Cloud TGT (Ticket Granting Ticket): Issued by Entra ID for the realm KERBEROS.MICROSOFTONLINE.COM. Stored in the client’s Kerberos ticket cache and used for cloud resource access.\\\\n-- KDC Proxy: Routes Kerberos traffic securely over the internet to Entra ID. This enables clients to obtain tickets without direct connectivity to domain controllers.\\\\n-- Azure Tenant Recognition: The Kerberos stack uses realm mapping and tenant ID to validate the Cloud TGT and issue service tickets. \\\\n- \\\\n+- **Cloud TGT**: Microsoft Entra ID issues this TGT for the realm `KERBEROS.MICROSOFTONLINE.COM`. It's stored in the client's Kerberos ticket cache and used for cloud resource access.\\\\n+- **KDC Proxy**: This protocol routes Kerberos traffic securely over the internet to Microsoft Entra ID. This routing enables clients to obtain tickets without direct connectivity to domain controllers.\\\\n+- **Azure tenant recognition**: The Kerberos stack uses realm mapping and the tenant ID to validate the Cloud TGT and issue service tickets.\\\\n \\\\n-### 4. Service ticket request and issuance:\\\\n+### 3. Service ticket request and issuance\\\\n \\\\n-**Access on-premises resources**:\\\\n-- Entra ID issues a partial TGT.\\\\n-- The client contacts an on-premises AD domain controller to exchange it for a full TGT.\\\\n-- This full TGT is then used to access on-premises resources like SMB shares or SQL servers.\\\\n+For client access to on-premises resources:\\\\n \\\\n-**Access cloud resources**:\\\\n-The client uses cloud TGT to request service tickets for cloud resources. No interaction with on-premises AD is needed.\\\\n-- When the user accesses a service (for example, Azure Files), the client requests a service ticket from Microsoft Entra ID by presenting the TGT.\\\\n-- The client sends a Ticket Granting Service Request (TGS-REQ) to Microsoft Entra ID.\\\\n-- Kerberos identifies the service (for example, cifs/mystuff.file.core.windows.net) and maps the domain to KERBEROS.MICROSOFTONLINE.COM. The KDC Proxy protocol enables Kerberos communication over the internet.\\\\n-- Microsoft Entra ID verifies the Cloud TGT and the user's identity and looks up the requested Service Principal Name (SPN) for the Azure Files resource registered in Microsoft Entra ID.\\\\n-- Generates a service ticket and encrypts it using the service principal's key and returns the ticket to the client in a TGS-REP.\\\\n-- The Kerberos stack processes the TGS-REP, extracts the ticket, and generates an Application Request (AP-REQ).\\\\n-- The AP-REQ is provided to SMB, which includes it in the request to Azure Files.\\\\n-- Azure Files decrypts the ticket and grants access. FSLogix can now read the user profile from Azure Files and load the Azure Virtual Desktop session.\\\\n+1. Microsoft Entra ID issues a partial TGT.\\\\n+1. The client contacts an on-premises Active Directory domain controller to exchange the partial TGT for a full TGT.\\\\n+1. The full TGT is used to access on-premises resources like SMB shares or SQL servers.\\\\n+\\\\n+The client uses the Cloud TGT to request service tickets for cloud resources. No interaction with on-premises Active Directory is needed. For client access to cloud resources:\\\\n+\\\\n+1. When the user accesses a service (for example, Azure Files), the client requests a service ticket from Microsoft Entra ID by presenting the TGT.\\\\n+1. The client sends a Ticket Granting Service Request (TGS-REQ) to Microsoft Entra ID.\\\\n+1. Kerberos identifies the service (for example, `cifs/mystuff.file.core.windows.net`) and maps the domain to `KERBEROS.MICROSOFTONLINE.COM`. The KDC Proxy protocol enables Kerberos communication over the internet.\\\\n+1. Microsoft Entra ID verifies the Cloud TGT and the user's identity. It also looks up the requested service principal name (SPN) for the Azure Files resource registered in Microsoft Entra ID.\\\\n+1. Microsoft Entra ID generates a service ticket and encrypts it by using the service principal's key. Microsoft Entra ID returns the ticket to the client in a Ticket Granting Service Reply (TGS-REP).\\\\n+1. The Kerberos stack processes the TGS-REP, extracts the ticket, and generates an Application Request (AP-REQ).\\\\n+1. The AP-REQ is provided to SMB, which includes it in the request to Azure Files.\\\\n+1. Azure Files decrypts the ticket and grants access. FSLogix can now read the user profile from Azure Files and load the Azure Virtual Desktop session.\\\\n \\\\n ### Summary\\\\n \\\\n | Feature | Cloud TGT | On-premises TGT |\\\\n |---|---|---|\\\\n-| Issuer | Entra ID | On-premises AD (via exchange) |\\\\n-| Realm | KERBEROS.MICROSOFTONLINE.COM | On-premises AD domain |\\\\n-| Authorization data | Cloud-specific | Full AD group memberships |\\\\n-| Exchange required | No | Yes (partial → full TGT) |\\\\n+| Issuer | Microsoft Entra ID | On-premises Active Directory (via exchange) |\\\\n+| Realm | `KERBEROS.MICROSOFTONLINE.COM` | On-premises Active Directory domain |\\\\n+| Authorization data | Cloud specific | Full Active Directory group memberships |\\\\n+| Exchange required | No | Yes (partial TGT to full TGT) |\\\\n | Use case | Azure Files, Azure SQL | SMB shares, legacy apps |\\\\n-| Verification tool (macOS) | tgt_cloud | tgt_ad |\\\\n-| Verification tool (Windows) | klist cloud_debug | klist get krbtgt |\\\\n+| Verification tool (macOS) | `tgt_cloud` | `tgt_ad` |\\\\n+| Verification tool (Windows) | `klist cloud_debug` | `klist get krbtgt` |\\\\n \\\\n ## Scenarios\\\\n \\\\n-### Windows authentication access to Azure SQL managed instance using Microsoft Entra Kerberos\\\\n-Kerberos authentication for Microsoft Entra ID enables Windows Authentication access to Azure SQL Managed Instance. Windows Authentication for managed instances empowers customers to move existing services to the cloud while maintaining a seamless user experience and provides the basis for infrastructure modernization.\\\\n-Detailed information at [Windows Authentication access to Azure SQL Managed Instance using Microsoft Entra Kerberos](/azure/azure-sql/managed-instance/winauth-azuread-overview) \\\\n+### Use Microsoft Entra Kerberos for Windows authentication access to Azure SQL Managed Instance\\\\n+\\\\n+Kerberos authentication for Microsoft Entra ID enables Windows authentication access to Azure SQL Managed Instance. Windows authentication for managed instances empowers customers to move existing services to the cloud while maintaining a seamless user experience. This ability provides the basis for infrastructure modernization.\\\\n+\\\\n+For detailed information, see [What is Windows Authentication for Microsoft Entra principals on Azure SQL Managed Instance?](/azure/azure-sql/managed-instance/winauth-azuread-overview).\\\\n \\\\n ### Use SSO to sign in to on-premises resources by using FIDO2 keys\\\\n-Microsoft Entra Kerberos users can sign in to Windows with modern credentials, such as FIDO2 security keys, and then access traditional Active Directory-based resources.  \\\\n-Detailed information at [Passwordless security key sign-in to on-premises resources](howto-authentication-passwordless-security-key-on-premises.md)\\\\n-\\\\n-### Enable Kerberos SSO to on-premises Active Directory and Microsoft Entra ID Kerberos resources in platform SSO\\\\n-Along with PSSO PRT, Microsoft Entra also issues both on-premises and cloud-based Kerberos Ticket Granting Tickets (TGTs) which are then shared with the native Kerberos stack in macOS via TGT mapping in PSSO.  \\\\n-Detailed information at: [Enable Kerberos SSO to on-premises Active Directory and Microsoft Entra ID Kerberos Resources in Platform SSO](~/identity/devices/device-join-macos-platform-single-sign-on-kerberos-configuration.md)\\\\n-\\\\n-### Profile containers with FSLogix for Azure Virtual Desktop\\\\n-For hosting user profiles for virtual desktops, customers can store profiles in Azure Files accessed via Microsoft Entra Kerberos.\\\\n-Microsoft Entra Kerberos enables Microsoft Entra ID to issue the necessary Kerberos tickets to access the file share with the industry-standard SMB protocol.\\\\n-Detailed information at: [Store FSLogix profile containers on Azure Files using Microsoft Entra ID in a hybrid scenario - FSLogix](/fslogix/how-to-configure-profile-container-entra-id-hybrid)\\\\n-    \\\\n+\\\\n+Microsoft Entra Kerberos users can sign in to Windows by using modern credentials, such as FIDO2 security keys, and then access traditional Active Directory-based resources.  \\\\n+\\\\n+For detailed information, see [Enable passwordless security key sign-in to on-premises resources by using Microsoft Entra ID](howto-authentication-passwordless-security-key-on-premises.md).\\\\n+\\\\n+### Enable Kerberos SSO to on-premises Active Directory and Microsoft Entra ID Kerberos resources in Platform SSO\\\\n+\\\\n+Along with the Platform SSO PRT, Microsoft Entra issues both on-premises and cloud-based Kerberos TGTs. These TGTs are then shared with the native Kerberos stack in macOS via TGT mapping in Platform SSO.  \\\\n+\\\\n+For detailed information, see [Enable Kerberos SSO to on-premises Active Directory and Microsoft Entra ID Kerberos resources in Platform SSO](~/identity/devices/device-join-macos-platform-single-sign-on-kerberos-configuration.md).\\\\n+\\\\n+### Store profile containers with FSLogix for Azure Virtual Desktop\\\\n+\\\\n+To host user profiles for virtual desktops, you can store profiles in an Azure file share accessed via Microsoft Entra Kerberos. Microsoft Entra Kerberos enables Microsoft Entra ID to issue the necessary Kerberos tickets to access the file share through the industry-standard SMB protocol.\\\\n+\\\\n+For detailed information, see [Store FSLogix profile containers on Azure Files using Microsoft Entra ID in a hybrid scenario](/fslogix/how-to-configure-profile-container-entra-id-hybrid).\\\\n+\\\\n ### Enable Microsoft Entra Kerberos authentication for hybrid identities on Azure Files\\\\n-Microsoft Entra Kerberos authentication hybrid users to access Azure file shares using Kerberos authentication, using Microsoft Entra ID to issue the necessary Kerberos tickets to access the file share with the SMB protocol.  \\\\n-Detailed information at: [Microsoft Entra Kerberos for hybrid identities on Azure Files](/azure/storage/files/storage-files-identity-auth-hybrid-identities-enable?tabs=azure-portal%2Cintune)\\\\n+\\\\n+Microsoft Entra Kerberos authentication enables hybrid users to access Azure file shares by using Kerberos authentication. This scenario uses Microsoft Entra ID to issue the necessary Kerberos tickets to access the file share through the SMB protocol.  \\\\n+\\\\n+For detailed information, see [Enable Microsoft Entra Kerberos authentication for hybrid identities on Azure Files](/azure/storage/files/storage-files-identity-auth-hybrid-identities-enable?tabs=azure-portal%2Cintune).\\\\n \\\\n ## Security considerations\\\\n-- Microsoft Entra Kerberos does not issue Partial TGTs to identities not synced to Entra ID.\\\\n-- Entra Kerberos uses a secure TGT exchange model via KDC Proxy, minimizing exposure to domain controllers and reducing attack surface.\\\\n+\\\\n+- Microsoft Entra Kerberos doesn't issue partial TGTs to identities that aren't synced to Microsoft Entra ID.\\\\n+- Microsoft Entra Kerberos uses a secure TGT exchange model via KDC Proxy. This model minimizes exposure to domain controllers and reduces the attack surface.\\\\n - Admins can configure group resolution policies to limit which groups are included in Kerberos tickets. These controls are essential for managing ticket size and reducing exposure to unnecessary group data.\\\\n-- Customers are advised to maintain clear separation between cloud and on-prem environments. Synchronizing sensitive accounts like krbtgt_AzureAD to on-prem AD is discouraged due to privilege escalation risks.\\\\n-- Use Azure AD Read-Only Domain Controller (RODC) object’s allow and deny lists are used to control which users are permitted to receive Partial TGTs from Entra ID for on-premises resource access.\\\\n+- We advise you to maintain clear separation between cloud and on-premises environments. We discourage synchronizing sensitive accounts like `krbtgt_AzureAD` to on-premises Active Directory due to privilege escalation risks.\\\\n+- Use the RODC object's allow list and block list to control which users can receive partial TGTs from Microsoft Entra ID for on-premises resource access.\\\\n+\\\\n+## Limitations and other considerations\\\\n \\\\n-## Limitations and considerations\\\\n+### Support limited to hybrid user identities\\\\n+\\\\n+Microsoft Entra Kerberos supports only hybrid user identities that are created in on-premises Active Directory and synchronized to Microsoft Entra ID via Microsoft Entra Connect.\\\\n+\\\\n+Cloud-only user accounts managed solely in Microsoft Entra ID aren't supported for Kerberos authentication.\\\\n \\\\n-### Support limited to Hybrid user identities: \\\\n-- Microsoft Entra Kerberos only supports hybrid user identities created in on-premises AD and synchronized to Microsoft Entra ID via Microsoft Entra Connect.\\\\n-- Cloud-only user accounts managed solely in Microsoft Entra ID aren't supported for Kerberos authentication.\\\\n ### Operating system and device restrictions\\\\n-- Microsoft Entra Kerberos is supported on Microsoft Entra joined or hybrid joined Windows 10 (2004+) and Windows 11 devices.\\\\n-- Some features depend on specific Windows versions and patches.\\\\n+\\\\n+Microsoft Entra Kerberos is supported on Microsoft Entra-joined or hybrid-joined Windows 10 (2004 or later) and Windows 11 devices. Some features depend on specific Windows versions and patches.\\\\n+\\\\n ### Network connectivity requirements for ACL configuration\\\\n-- While users can access Azure file shares over the internet without direct domain controller connectivity, configuring Windows ACLs or file-level permissions requires unimpeded network access to on-premises domain controllers.\\\\n-### No Cross-Tenant or Guest user support\\\\n-- B2B guest users or users from other Microsoft Entra tenants can't currently authenticate using Microsoft Entra Kerberos.\\\\n+\\\\n+Users can access Azure file shares over the internet without direct connectivity to domain controllers. However, configuring Windows access control lists (ACLs) or file-level permissions requires unimpeded network access to on-premises domain controllers.\\\\n+\\\\n+### No cross-tenant or guest user support\\\\n+\\\\n+Business-to-business guest users or users from other Microsoft Entra tenants can't currently authenticate via Microsoft Entra Kerberos.\\\\n+\\\\n ### Password expiration\\\\n-- Service principal passwords for storage accounts expire every six months and need to be rotated to maintain access.\\\\n+\\\\n+Service principal passwords for storage accounts expire every six months and need to be rotated to maintain access.\\\\n+\\\\n ### Group membership limits\\\\n-- Kerberos tickets have a size constraint that limits the number of group SIDs (Security Identifiers) that can be included. The default cap is 1,010 groups per ticket. If exceeded, only the first 1010 are included, which can cause access failures for users in large organizations.\\\\n-### MFA incompatibility for Azure files authentication\\\\n-- Microsoft Entra Kerberos authentication for Azure file shares doesn't support multifactor authentication (MFA).\\\\n-- Conditional Access policies enforcing MFA must exclude the storage account application or users experience authentication failures.\\\\n-- Exclude Azure Files from Conditional Access policies that require MFA. This can be done by scoping the policy to exclude the storage account or the specific application accessing Azure Files.\\\\n+\\\\n+Kerberos tickets have a size constraint that limits the number of group SIDs that you can include. The default cap is 1,010 groups per ticket. If you exceed that cap, only the first 1,010 are included. The exclusion of the remainder can cause access failures for users in large organizations.\\\\n+\\\\n+### MFA incompatibility for Azure Files authentication\\\\n+\\\\n+Microsoft Entra Kerberos authentication for Azure file shares doesn't support MFA. Microsoft Entra Conditional Access policies that enforce MFA must exclude the storage account application, or users experience authentication failures.\\\\n+\\\\n+Exclude Azure Files from Conditional Access policies that require MFA. You can accomplish this task by scoping the policy to exclude the storage account or the specific application that accesses Azure Files.\\\\n+\\\\n ### Attribute synchronization requirements\\\\n-- Proper synchronization of key on-premises AD user attributes is essential for Microsoft Entra Kerberos to work, including onPremisesDomainName, onPremisesUserPrincipalName, and onPremisesSamAccountName.\\\\n-### Single AD method per Azure Storage account\\\\n-- For Azure Files identity-based authentication, only one AD method (Microsoft Entra Kerberos, on-premises AD DS, or Microsoft Entra Domain Services) can be enabled per storage account at a time.\\\\n-- Switching between methods requires disabling the current method first.\\\\n-### Kerberos encryption settings\\\\n-- Kerberos ticket encryption with Microsoft Entra Kerberos uses AES-256 exclusively. SMB channel encryption can be configured separately based on requirements.\\\\n \\\\n+Proper synchronization of key on-premises Active Directory user attributes is essential for Microsoft Entra Kerberos to work. These attributes include `onPremisesDomainName`, `onPremisesUserPrincipalName`, and `onPremisesSamAccountName`.\\\\n \\\\n-## Getting started with Microsoft Entra Kerberos\\\\n+### Single Active Directory method per Azure Storage account\\\\n+\\\\n+For Azure Files identity-based authentication, you can enable only one Active Directory method at a time per storage account. These methods include Microsoft Entra Kerberos, on-premises AD DS, and Microsoft Entra Domain Services. Switching between methods requires disabling the current method first.\\\\n \\\\n-1. **Set Up Microsoft Entra Connect**:\\\\n-    - Synchronize on-premises AD DS users to Microsoft Entra ID. For details, see the [Microsoft Entra Connect installation guide](../hybrid/connect/how-to-connect-install-prerequisites.md).\\\\n+### Kerberos encryption settings\\\\n+\\\\n+Kerberos ticket encryption with Microsoft Entra Kerberos uses AES-256 exclusively. You can configure SMB channel encryption separately, based on your requirements.\\\\n \\\\n-2. **Enable Microsoft Entra Kerberos**:\\\\n-    - Configure Azure Files or other services to use Microsoft Entra Kerberos authentication. For instructions, see [Enable Microsoft Entra Kerberos for Azure Files](/azure/storage/files/storage-files-identity-auth-hybrid-cloud-trust?tabs=azure-portal).\\\\n+## Getting started with Microsoft Entra Kerberos\\\\n \\\\n-3. **Client Configuration**:\\\\n-    - Ensure Windows clients are up to date and [configured for Microsoft Entra Kerberos](/azure/azure-sql/managed-instance/winauth-azuread-setup-incoming-trust-based-flow#configure-the-group-policy-object-gpo).\\\\n+1. Set up Microsoft Entra Connect to synchronize on-premises AD DS users to Microsoft Entra ID. For details, see the [Microsoft Entra Connect installation guide](../hybrid/connect/how-to-connect-install-prerequisites.md).\\\\n \\\\n-4. **Manage service principals**:\\\\n-    - Monitor and rotate service principal passwords as required.\\\\n+2. Configure Azure Files or other services to use Microsoft Entra Kerberos authentication. For instructions, see [Enable Microsoft Entra Kerberos authentication](/azure/storage/files/storage-files-identity-auth-hybrid-cloud-trust#enable-microsoft-entra-kerberos-authentication?tabs=azure-portal).\\\\n \\\\n-5. **Monitor authentication activity**:\\\\n-    - Use [Microsoft Entra ID reports and monitoring tools](../monitoring-health/overview-monitoring-health.md) to keep track of authentication events.\\\\n+3. Ensure that Windows clients are up to date and [configured for Microsoft Entra Kerberos](/azure/azure-sql/managed-instance/winauth-azuread-setup-incoming-trust-based-flow#configure-the-group-policy-object-gpo).\\\\n \\\\n+4. Monitor and rotate service principal passwords as required.\\\\n \\\\n-## Learn more\\\\n+5. Use [Microsoft Entra ID reports and monitoring tools](../monitoring-health/overview-monitoring-health.md) to keep track of authentication events.\\\\n \\\\n--   [Create the trusted domain object](/azure/storage/files/storage-files-identity-auth-hybrid-cloud-trust?tabs=azure-portal&preserve-view=true#create-the-trusted-domain-object)\\\\n--   [Configure clients to retrieve Kerberos tickets](/azure/storage/files/storage-files-identity-auth-hybrid-identities-enable?tabs=azure-portal%2Cintune&preserve-view=true#configure-the-clients-to-retrieve-kerberos-tickets)\\\\n--   [Configure the Group Policy Object (GPO) for Azure SQL managed instance](/azure/azure-sql/managed-instance/winauth-azuread-setup-incoming-trust-based-flow?view=azuresql&preserve-view=true#configure-the-group-policy-object-gpo)\\\\n+## Related content\\\\n \\\\n+- [Create the trusted domain object](/azure/storage/files/storage-files-identity-auth-hybrid-cloud-trust?tabs=azure-portal&preserve-view=true#create-the-trusted-domain-object)\\\\n+- [Configure clients to retrieve Kerberos tickets](/azure/storage/files/storage-files-identity-auth-hybrid-identities-enable?tabs=azure-portal%2Cintune&preserve-view=true#configure-the-clients-to-retrieve-kerberos-tickets)\\\\n+- [Configure the Group Policy Object (GPO) for Azure SQL Managed Instance](/azure/azure-sql/managed-instance/winauth-azuread-setup-incoming-trust-based-flow?view=azuresql&preserve-view=true#configure-the-group-policy-object-gpo)\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"776b9b102696aeb3a4f63c418a26d23ee20d6944\\\",\\r\\n    \\\"filename\\\": \\\"docs/identity/hybrid/cloud-sync/reference-version-history.md\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 1,\\r\\n    \\\"deletions\\\": 1,\\r\\n    \\\"changes\\\": 2,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fhybrid%2Fcloud-sync%2Freference-version-history.md\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fidentity%2Fhybrid%2Fcloud-sync%2Freference-version-history.md\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fidentity%2Fhybrid%2Fcloud-sync%2Freference-version-history.md?ref=3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3\\\",\\r\\n    \\\"patch\\\": \\\"@@ -6,7 +6,7 @@ author: omondiatieno\\\\n manager: mwongerapk\\\\n ms.service: entra-id\\\\n ms.topic: reference\\\\n-ms.date: 04/09/2025\\\\n+ms.date: 09/23/2025\\\\n ms.subservice: app-provisioning\\\\n ms.author: jomondi\\\\n ---\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"sha\\\": \\\"e8e510884358c7ae14b70e4737864948ed468bc0\\\",\\r\\n    \\\"filename\\\": \\\"docs/includes/cloud-sync-version-history.md\\\",\\r\\n    \\\"status\\\": \\\"modified\\\",\\r\\n    \\\"additions\\\": 2,\\r\\n    \\\"deletions\\\": 1,\\r\\n    \\\"changes\\\": 3,\\r\\n    \\\"blob_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/blob/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fincludes%2Fcloud-sync-version-history.md\\\",\\r\\n    \\\"raw_url\\\": \\\"https://github.com/MicrosoftDocs/entra-docs/raw/3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3/docs%2Fincludes%2Fcloud-sync-version-history.md\\\",\\r\\n    \\\"contents_url\\\": \\\"https://api.github.com/repos/MicrosoftDocs/entra-docs/contents/docs%2Fincludes%2Fcloud-sync-version-history.md?ref=3fda0816a3a4cfdee7ae0d1b839e19d594fa6ef3\\\",\\r\\n    \\\"patch\\\": \\\"@@ -29,10 +29,11 @@ Sept 22, 2025: released for download only\\\\n - Simplified how to choose your provisioning scenario\\\\n - Configured installation for the current cloud environment by default\\\\n - Faster enumeration for large groups by preventing service timeouts\\\\n-- Improved sync reliability with a registry entry named **RegistryValueNameUserPasswordLength** to configure user password length\\\\n - Improved how admins can view their domain controller priority list\\\\n - Added UserAccountControl as a System for Cross-domain Identity Management (SCIM) property\\\\n+- Added a configurable password length for newly created users. The default password length for newly created users is 256. Admins can set an integer value between 127 and 256 for newly created users by creating a registry entry with REG_DWORD data type at:\\\\n \\\\n+  `HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Azure AD Connect Agents\\\\\\\\Azure AD Connect Provisioning Agent\\\\\\\\UserPasswordLength`\\\\n \\\\n ## 1.1.1586.0\\\\n \\\"\\r\\n  }\\r\\n]. Please summarise it in a few sentences, using UK grammar and ensure the response is formatted for markdown. Do not start the response with here is summary.\"}",
    "Response": "The commits introduce updates to Microsoft Entra documentation. Key changes include clarifying SSPR policy management via PowerShell and Microsoft Graph APIs, enhancing the Kerberos protocol explanation with new diagrams and detailed workflows, and updating version history for Microsoft Entra Cloud Sync, including a new feature for configuring user password length. The documentation also refines explanations around hybrid identity, security considerations, and limitations for Kerberos authentication.",
    "Model": "google:gemini-2.5-flash-lite",
    "Provider": "google",
    "ModelName": "gemini-2.5-flash-lite",
    "Timestamp": "2025-09-24T19:01:05.9783791+00:00"
  },
  "files": [
    {
      "filename": "docs/identity/authentication/concept-sspr-policy.md",
      "status": "modified",
      "additions": 22,
      "deletions": 1
    },
    {
      "filename": "docs/identity/authentication/how-to-unlock-users-for-mandatory-multifactor-authentication.md",
      "status": "modified",
      "additions": 15,
      "deletions": 3
    },
    {
      "filename": "docs/identity/authentication/kerberos.md",
      "status": "modified",
      "additions": 176,
      "deletions": 149
    },
    {
      "filename": "docs/identity/hybrid/cloud-sync/reference-version-history.md",
      "status": "modified",
      "additions": 1,
      "deletions": 1
    },
    {
      "filename": "docs/includes/cloud-sync-version-history.md",
      "status": "modified",
      "additions": 2,
      "deletions": 1
    }
  ]
}